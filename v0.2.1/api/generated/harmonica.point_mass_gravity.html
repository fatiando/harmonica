


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    
        <title>harmonica.point_mass_gravity &mdash; Harmonica</title>
    


  
  
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/plot_directive.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-rendered-html.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="harmonica.prism_gravity" href="harmonica.prism_gravity.html" />
    <link rel="prev" title="harmonica.EQLHarmonicSpherical" href="harmonica.EQLHarmonicSpherical.html" />
    <!-- Plausible analytics for anonymous usage statistics -->
    <script defer data-domain="fatiando.org" src="https://plausible.io/js/plausible.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/harmonica-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                v0.2.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../citing.html">Citing Harmonica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gallery/index.html">Gallery</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../sample_data/index.html">Sample Data</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#gravity-corrections">Gravity Corrections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#equivalent-layers">Equivalent Layers</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#forward-modelling">Forward modelling</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">harmonica.point_mass_gravity</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#examples-using-harmonica-point-mass-gravity">Examples using <code class="docutils literal notranslate"><span class="pre">harmonica.point_mass_gravity</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="harmonica.prism_gravity.html">harmonica.prism_gravity</a></li>
<li class="toctree-l3"><a class="reference internal" href="harmonica.tesseroid_gravity.html">harmonica.tesseroid_gravity</a></li>
<li class="toctree-l3"><a class="reference internal" href="harmonica.prism_layer.html">harmonica.prism_layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="harmonica.DatasetAccessorPrismLayer.html">harmonica.DatasetAccessorPrismLayer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#isostasy">Isostasy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#input-and-output">Input and Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#synthetic-models-and-surveys">Synthetic models and surveys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#datasets">Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#utilities">Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../changes.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>

            
          

    
        <p class="caption">
            <span class="caption-text">
            
                Getting help and contributing
            
            </span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://www.fatiando.org"><i class="fa fa-external-link-square fa-fw"></i> Fatiando a Terra</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/fatiando/harmonica/blob/master/CONTRIBUTING.md"><i class="fa fa-users fa-fw"></i> Contributing</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/fatiando/harmonica/blob/master/CODE_OF_CONDUCT.md"><i class="fa fa-gavel fa-fw"></i> Code of Conduct</a></li>
            
                <li class="toctree-l1"><a href="http://contact.fatiando.org"><i class="fa fa-comment fa-fw"></i> Contact</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/fatiando/harmonica"><i class="fa fa-github fa-fw"></i> Source Code</a></li>
            
        </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Harmonica</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          
















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">API Reference</a> &raquo;</li>
        
      <li>harmonica.point_mass_gravity</li>
    
    
    <li class="source-link">
        
            
                
                
                <a href="https://github.com/fatiando/harmonica/issues/new?title=Suggested%20improvement%20for%20api/generated/harmonica.point_mass_gravity&body=Please%20describe%20what%20could%20be%20improved%20about%20this%20page%20or%20the%20typo/mistake%20that%20you%20found%3A"
                   class="fa fa-github"> Improve this page</a>
            
        
        
    </li>

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="harmonica-point-mass-gravity">
<h1>harmonica.point_mass_gravity<a class="headerlink" href="#harmonica-point-mass-gravity" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="harmonica.point_mass_gravity">
<code class="sig-prename descclassname"><span class="pre">harmonica.</span></code><code class="sig-name descname"><span class="pre">point_mass_gravity</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coordinates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_system</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cartesian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'float64'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/harmonica/forward/point_mass.html#point_mass_gravity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#harmonica.point_mass_gravity" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute gravitational fields of point masses.</p>
<p>It can compute the gravitational fields of point masses on a set of
computation points defined either in Cartesian or geocentric spherical
coordinates.</p>
<p>The gravitational potential field generated by a point mass with mass
<span class="math notranslate nohighlight">\(m\)</span> located at a point <span class="math notranslate nohighlight">\(Q\)</span> on a computation point <span class="math notranslate nohighlight">\(P\)</span> can
be computed as:</p>
<div class="math notranslate nohighlight">
\[V(P) = \frac{G m}{l},\]</div>
<p>where <span class="math notranslate nohighlight">\(G\)</span> is the gravitational constant and <span class="math notranslate nohighlight">\(l\)</span> is the
Euclidean distance between <span class="math notranslate nohighlight">\(P\)</span> and <span class="math notranslate nohighlight">\(Q\)</span> <a class="reference internal" href="../../references.html#blakely1995" id="id1"><span>[Blakely1995]</span></a>.</p>
<p>In Cartesian coordinates, the points <span class="math notranslate nohighlight">\(P\)</span> and <span class="math notranslate nohighlight">\(Q\)</span> are given by
<span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(z\)</span> coordinates, which can be translated
into <code class="docutils literal notranslate"><span class="pre">northing</span></code>, <code class="docutils literal notranslate"><span class="pre">easting</span></code> and <code class="docutils literal notranslate"><span class="pre">upward</span></code>, respectively. If <span class="math notranslate nohighlight">\(P\)</span>
is located at <span class="math notranslate nohighlight">\((x, y, z)\)</span>, and <span class="math notranslate nohighlight">\(Q\)</span> at <span class="math notranslate nohighlight">\((x_p, y_p, z_p)\)</span>,
the distance <span class="math notranslate nohighlight">\(l\)</span> can be computed as:</p>
<div class="math notranslate nohighlight">
\[l = \sqrt{ (x - x_p)^2 + (y - y_p)^2 + (z - z_p)^2 }.\]</div>
<p>The gradient of the potential, also known as the gravitational acceleration
vector <span class="math notranslate nohighlight">\(\vec{g}\)</span>, is defined as:</p>
<div class="math notranslate nohighlight">
\[\vec{g} = \nabla V\]</div>
<p>and has components <span class="math notranslate nohighlight">\(g_{northing}(P)\)</span>, <span class="math notranslate nohighlight">\(g_{easting}(P)\)</span> and
<span class="math notranslate nohighlight">\(g_{upward}(P)\)</span> given by</p>
<div class="math notranslate nohighlight">
\[g_{northing}(P) = - \frac{G m}{l^3} (x - x_p),\]</div>
<div class="math notranslate nohighlight">
\[g_{easting}(P) = - \frac{G m}{l^3} (y - y_p)\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[g_{upward}(P) = - \frac{G m}{l^3} (z - z_p).\]</div>
<p>We define the downward component of the gravitational acceleration as the
opposite of <span class="math notranslate nohighlight">\(g_{upward}\)</span> (remember that <span class="math notranslate nohighlight">\(z\)</span> points upwards):</p>
<div class="math notranslate nohighlight">
\[g_{z}(P) = \frac{G m}{l^3} (z - z_p).\]</div>
<p>On a geocentric spherical coordinate system, the points <span class="math notranslate nohighlight">\(P\)</span> and
<span class="math notranslate nohighlight">\(Q\)</span> are given by the <code class="docutils literal notranslate"><span class="pre">longitude</span></code>, <code class="docutils literal notranslate"><span class="pre">latitude</span></code> and <code class="docutils literal notranslate"><span class="pre">radius</span></code>
coordinates, i.e. <span class="math notranslate nohighlight">\(\lambda\)</span>, <span class="math notranslate nohighlight">\(\varphi\)</span> and <span class="math notranslate nohighlight">\(r\)</span>,
respectively. On this coordinate system, the Euclidean distance between
<span class="math notranslate nohighlight">\(P(r, \varphi, \lambda)\)</span> and <span class="math notranslate nohighlight">\(Q(r_p, \varphi_p, \lambda_p)\)</span> can
be calculated  as follows <a class="reference internal" href="../../references.html#grombein2013" id="id2"><span>[Grombein2013]</span></a>:</p>
<div class="math notranslate nohighlight">
\[l = \sqrt{ r^2 + r_p^2 - 2 r r_p \cos \Psi },\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\cos \Psi = \sin \varphi \sin \varphi_p +
\cos \varphi \cos \varphi_p \cos(\lambda - \lambda_p).\]</div>
<p>The radial component of the acceleration vector on a local North-oriented
system whose origin is located on the point <span class="math notranslate nohighlight">\(P(r, \varphi, \lambda)\)</span>
is given by <a class="reference internal" href="../../references.html#grombein2013" id="id3"><span>[Grombein2013]</span></a>:</p>
<div class="math notranslate nohighlight">
\[g_r(P) =  - \frac{G m}{l^3} (r - r_p \cos \Psi).\]</div>
<p>We define the downward component of the gravitational acceleration
<span class="math notranslate nohighlight">\(g_z\)</span> as the opposite of the radial component:</p>
<div class="math notranslate nohighlight">
\[g_z(P) = \frac{G m}{l^3} (r - r_p \cos \Psi).\]</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When working in Cartesian coordinates, the <strong>z direction points
upwards</strong>, i.e. positive and negative values of <code class="docutils literal notranslate"><span class="pre">upward</span></code> represent
points above and below the surface, respectively. But remember that the
<code class="docutils literal notranslate"><span class="pre">g_z</span></code> field returns the downward component of the gravitational
acceleration.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When working in geocentric spherical coordinates, remember that the
<code class="docutils literal notranslate"><span class="pre">g_z</span></code> field returns the downward component of the gravitational
acceleration on the local North oriented coordinate system. It is
equivalent to the opposite of the radial component, therefore it’s
positive if the acceleration vector points inside the spheroid.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coordinates</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em> or </em><em>array</em>) – List or array containing the coordinates of computation points in the
following order: <code class="docutils literal notranslate"><span class="pre">easting</span></code>, <code class="docutils literal notranslate"><span class="pre">northing</span></code> and <code class="docutils literal notranslate"><span class="pre">upward</span></code> (if
coordinates given in Cartesian coordinates), or <code class="docutils literal notranslate"><span class="pre">longitude</span></code>,
<code class="docutils literal notranslate"><span class="pre">latitude</span></code> and <code class="docutils literal notranslate"><span class="pre">radius</span></code> (if given on a spherical geocentric
coordinate system).
All <code class="docutils literal notranslate"><span class="pre">easting</span></code>, <code class="docutils literal notranslate"><span class="pre">northing</span></code> and <code class="docutils literal notranslate"><span class="pre">upward</span></code> should be in meters.
Both <code class="docutils literal notranslate"><span class="pre">longitude</span></code> and <code class="docutils literal notranslate"><span class="pre">latitude</span></code> should be in degrees and <code class="docutils literal notranslate"><span class="pre">radius</span></code>
in meters.</p></li>
<li><p><strong>points</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em> or </em><em>array</em>) – List or array containing the coordinates of the point masses in the
following order: <code class="docutils literal notranslate"><span class="pre">easting</span></code>, <code class="docutils literal notranslate"><span class="pre">northing</span></code> and <code class="docutils literal notranslate"><span class="pre">upward</span></code> (if
coordinates given in Cartesian coordinates), or <code class="docutils literal notranslate"><span class="pre">longitude</span></code>,
<code class="docutils literal notranslate"><span class="pre">latitude</span></code> and <code class="docutils literal notranslate"><span class="pre">radius</span></code> (if given on a spherical geocentric
coordinate system).
All <code class="docutils literal notranslate"><span class="pre">easting</span></code>, <code class="docutils literal notranslate"><span class="pre">northing</span></code> and <code class="docutils literal notranslate"><span class="pre">upward</span></code> should be in meters.
Both <code class="docutils literal notranslate"><span class="pre">longitude</span></code> and <code class="docutils literal notranslate"><span class="pre">latitude</span></code> should be in degrees and <code class="docutils literal notranslate"><span class="pre">radius</span></code>
in meters.</p></li>
<li><p><strong>masses</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em> or </em><em>array</em>) – List or array containing the mass of each point mass in kg.</p></li>
<li><p><strong>field</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – <p>Gravitational field that wants to be computed.
The available fields coordinates are:</p>
<ul>
<li><p>Gravitational potential: <code class="docutils literal notranslate"><span class="pre">potential</span></code></p></li>
<li><p>Downward acceleration: <code class="docutils literal notranslate"><span class="pre">g_z</span></code></p></li>
<li><p>Northing acceleration: <code class="docutils literal notranslate"><span class="pre">g_northing</span></code></p></li>
<li><p>Easting acceleration: <code class="docutils literal notranslate"><span class="pre">g_easting</span></code></p></li>
</ul>
</p></li>
<li><p><strong>coordinate_system</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) – Coordinate system of the coordinates of the computation points and the
point masses.
Available coordinates systems: <code class="docutils literal notranslate"><span class="pre">cartesian</span></code>, <code class="docutils literal notranslate"><span class="pre">spherical</span></code>.
Default <code class="docutils literal notranslate"><span class="pre">cartesian</span></code>.</p></li>
<li><p><strong>parallel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – If True the computations will run in parallel using Numba built-in
parallelization. If False, the forward model will run on a single core.
Might be useful to disable parallelization if the forward model is run
by an already parallelized workflow. Default to True.</p></li>
<li><p><strong>dtype</strong> (<em>data-type</em><em> (</em><em>optional</em><em>)</em>) – Data type assigned to resulting gravitational field. Default to
<code class="docutils literal notranslate"><span class="pre">np.float64</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong> (<em>array</em>) – Gravitational field generated by the <code class="docutils literal notranslate"><span class="pre">point_mass</span></code> on the computation
points defined in <code class="docutils literal notranslate"><span class="pre">coordinates</span></code>.
The potential is given in SI units, the accelerations in mGal and the
Marussi tensor components in Eotvos.</p>
</dd>
</dl>
</dd></dl>

<div class="section" id="examples-using-harmonica-point-mass-gravity">
<h2>Examples using <code class="docutils literal notranslate"><span class="pre">harmonica.point_mass_gravity</span></code><a class="headerlink" href="#examples-using-harmonica-point-mass-gravity" title="Permalink to this headline">¶</a></h2>
<div class="sphx-glr-thumbcontainer" tooltip="The simplest geometry used to compute gravitational fields are point masses. Although modelling..."><div class="figure align-default" id="id4">
<img alt="Point Masses in Cartesian Coordinates" src="../../_images/sphx_glr_point_mass_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="../../gallery/forward/point_mass.html#sphx-glr-gallery-forward-point-mass-py"><span class="std std-ref">Point Masses in Cartesian Coordinates</span></a></span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
</div><div style='clear:both'></div></div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="harmonica.prism_gravity.html" class="btn btn-neutral float-right" title="harmonica.prism_gravity" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="harmonica.EQLHarmonicSpherical.html" class="btn btn-neutral float-left" title="harmonica.EQLHarmonicSpherical" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018-2021, The Harmonica Developers
      <span class="lastupdated">
        Last updated on Apr 13, 2021.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>