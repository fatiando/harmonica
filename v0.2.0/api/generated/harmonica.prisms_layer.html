


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    
        <title>harmonica.prisms_layer &mdash; Harmonica</title>
    


  
  
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/plot_directive.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-rendered-html.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="harmonica.DatasetAccessorPrismsLayer" href="harmonica.DatasetAccessorPrismsLayer.html" />
    <link rel="prev" title="harmonica.tesseroid_gravity" href="harmonica.tesseroid_gravity.html" />
    <!-- Plausible analytics for anonymous usage statistics -->
    <script defer data-domain="fatiando.org" src="https://plausible.io/js/plausible.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/harmonica-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                v0.2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <p><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../citing.html">Citing Harmonica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gallery/index.html">Gallery</a></li>
</ul>
<p><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../sample_data/index.html">Sample Data</a></li>
</ul>
<p><span class="caption-text">Reference documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#gravity-corrections">Gravity Corrections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#equivalent-layers">Equivalent Layers</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#forward-modelling">Forward modelling</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="harmonica.point_mass_gravity.html">harmonica.point_mass_gravity</a></li>
<li class="toctree-l3"><a class="reference internal" href="harmonica.prism_gravity.html">harmonica.prism_gravity</a></li>
<li class="toctree-l3"><a class="reference internal" href="harmonica.tesseroid_gravity.html">harmonica.tesseroid_gravity</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">harmonica.prisms_layer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#examples-using-harmonica-prisms-layer">Examples using <code class="docutils literal notranslate"><span class="pre">harmonica.prisms_layer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="harmonica.DatasetAccessorPrismsLayer.html">harmonica.DatasetAccessorPrismsLayer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#isostasy">Isostasy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#input-and-output">Input and Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#synthetic-models-and-surveys">Synthetic models and surveys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#datasets">Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#utilities">Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../changes.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>

            
          

    
        <p class="caption">
            <span class="caption-text">
            
                Getting help and contributing
            
            </span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://www.fatiando.org"><i class="fa fa-external-link-square fa-fw"></i> Fatiando a Terra</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/fatiando/harmonica/blob/master/CONTRIBUTING.md"><i class="fa fa-users fa-fw"></i> Contributing</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/fatiando/harmonica/blob/master/CODE_OF_CONDUCT.md"><i class="fa fa-gavel fa-fw"></i> Code of Conduct</a></li>
            
                <li class="toctree-l1"><a href="http://contact.fatiando.org"><i class="fa fa-comment fa-fw"></i> Contact</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/fatiando/harmonica"><i class="fa fa-github fa-fw"></i> Source Code</a></li>
            
        </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Harmonica</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          
















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">API Reference</a> &raquo;</li>
        
      <li>harmonica.prisms_layer</li>
    
    
    <li class="source-link">
        
            
                
                
                <a href="https://github.com/fatiando/harmonica/issues/new?title=Suggested%20improvement%20for%20api/generated/harmonica.prisms_layer&body=Please%20describe%20what%20could%20be%20improved%20about%20this%20page%20or%20the%20typo/mistake%20that%20you%20found%3A"
                   class="fa fa-github"> Improve this page</a>
            
        
        
    </li>

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="harmonica-prisms-layer">
<h1>harmonica.prisms_layer<a class="headerlink" href="#harmonica-prisms-layer" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="harmonica.prisms_layer">
<code class="sig-prename descclassname">harmonica.</code><code class="sig-name descname">prisms_layer</code><span class="sig-paren">(</span><em class="sig-param">coordinates</em>, <em class="sig-param">surface</em>, <em class="sig-param">reference</em>, <em class="sig-param">properties=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/harmonica/forward/prisms_layer.html#prisms_layer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#harmonica.prisms_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a layer of prisms of equal size</p>
<p>Build a regular grid of prisms of equal size on the horizontal directions
with variable top and bottom boundaries and properties like density,
magnetization, etc. The function returns a <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v0.17.1.dev0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a>
containing <code class="docutils literal notranslate"><span class="pre">easting</span></code>, <code class="docutils literal notranslate"><span class="pre">northing</span></code>, <code class="docutils literal notranslate"><span class="pre">top</span></code> and <code class="docutils literal notranslate"><span class="pre">bottom</span></code> coordinates,
and all physical properties as <code class="docutils literal notranslate"><span class="pre">data_var</span></code> s. The <code class="docutils literal notranslate"><span class="pre">easting</span></code> and
<code class="docutils literal notranslate"><span class="pre">northing</span></code> coordinates correspond to the location of the center of each
prism.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">prisms_layer</span></code> dataset accessor can be used to access special methods
and attributes for the layer of prisms, like the horizontal dimensions of
the prisms, getting the boundaries of each prisms, etc.
See <code class="xref py py-class docutils literal notranslate"><span class="pre">XarrayAcessorPrismLayer</span></code> for the definition of these methods
and attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coordinates</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – List containing the coordinates of the centers of the prisms in the
following order: <code class="docutils literal notranslate"><span class="pre">easting</span></code>, <code class="docutils literal notranslate"><span class="pre">northing</span></code>. The arrays must be 1d
arrays containing the coordiantes of the centers per axis, or could be
2d arrays as the ones returned by :func:<code class="docutils literal notranslate"><span class="pre">numpy.meshgrid</span></code>. All
coordinates should be in meters and should define a regular grid.</p></li>
<li><p><strong>surface</strong> (<em>2d-array</em>) – Array used to create the uppermost boundary of the prisms layer. All
heights should be in meters. On every point where <code class="docutils literal notranslate"><span class="pre">surface</span></code> is below
<code class="docutils literal notranslate"><span class="pre">reference</span></code>, the <code class="docutils literal notranslate"><span class="pre">surface</span></code> value will be used to set the
<code class="docutils literal notranslate"><span class="pre">bottom</span></code> boundary of that prism, while the <code class="docutils literal notranslate"><span class="pre">reference</span></code> value will
be used to set the <code class="docutils literal notranslate"><span class="pre">top</span></code> boundary of the prism.</p></li>
<li><p><strong>reference</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> or </em><em>2d-array</em>) – Reference surface used to create the lowermost boundary of the prisms
layer. It can be either a plane or an irregular surface passed as 2d
array. Height(s) must be in meters.</p></li>
<li><p><strong>properties</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a>) – Dictionary containing the physical properties of the prisms. The keys
must be strings that will be used to name the corresponding <code class="docutils literal notranslate"><span class="pre">data_var</span></code>
inside the <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v0.17.1.dev0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a>, while the values must be 2d-arrays.
All physical properties must be passed in SI units. If None, no
<code class="docutils literal notranslate"><span class="pre">data_var</span></code> will be added to the <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v0.17.1.dev0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a>. Default is
None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>dataset</strong> (<a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v0.17.1.dev0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a>) – Dataset containing the coordinates of the center of each prism, the
height of its top and bottom boundaries and its corresponding physical
properties.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">harmonica.PrismsLayer</span></code></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a synthetic relief</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">easting</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">northing</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surface</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span> <span class="o">=</span> <span class="mf">2670.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">surface</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define a layer of prisms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prisms</span> <span class="o">=</span> <span class="n">prisms_layer</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">(</span><span class="n">easting</span><span class="p">,</span> <span class="n">northing</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">surface</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">reference</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;density&quot;</span><span class="p">:</span> <span class="n">density</span><span class="p">},</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">prisms</span><span class="p">)</span>
<span class="go">&lt;xarray.Dataset&gt;</span>
<span class="go">Dimensions:   (easting: 5, northing: 4)</span>
<span class="go">Coordinates:</span>
<span class="go">  * easting   (easting) float64 0.0 2.5 5.0 7.5 10.0</span>
<span class="go">  * northing  (northing) float64 2.0 4.0 6.0 8.0</span>
<span class="go">    top       (northing, easting) float64 0.0 1.0 2.0 3.0 ... 17.0 18.0 19.0</span>
<span class="go">    bottom    (northing, easting) float64 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0</span>
<span class="go">Data variables:</span>
<span class="go">    density   (northing, easting) float64 2.67e+03 2.67e+03 ... 2.67e+03</span>
<span class="go">:ivar ~prisms_layer.coords_units: meters</span>
<span class="go">:ivar ~prisms_layer.properties_units: SI</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get the boundaries of the layer (will exceed the region)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">prisms</span><span class="o">.</span><span class="n">prisms_layer</span><span class="o">.</span><span class="n">boundaries</span><span class="p">)</span>
<span class="go">(-1.25, 11.25, 1.0, 9.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get the boundaries of one of the prisms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">prisms</span><span class="o">.</span><span class="n">prisms_layer</span><span class="o">.</span><span class="n">get_prism</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="go">(3.75, 6.25, 1.0, 3.0, 0.0, 2.0)</span>
</pre></div>
</div>
</dd></dl>

<section id="examples-using-harmonica-prisms-layer">
<h2>Examples using <code class="docutils literal notranslate"><span class="pre">harmonica.prisms_layer</span></code><a class="headerlink" href="#examples-using-harmonica-prisms-layer" title="Permalink to this headline">¶</a></h2>
<div class="sphx-glr-thumbcontainer" tooltip="One way to model three dimensional structures is to create a set of prisms that approximates th..."><figure class="align-default" id="id1">
<img alt="Layer of prisms" src="../../_images/sphx_glr_prisms_layer_thumb.png" />
<figcaption>
<p><span class="caption-text"><a class="reference internal" href="../../gallery/forward/prisms_layer.html#sphx-glr-gallery-forward-prisms-layer-py"><span class="std std-ref">Layer of prisms</span></a></span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</div><div class="sphx-glr-thumbcontainer" tooltip="One possible application of the harmonica.prisms_layer function is to create a model of the ter..."><figure class="align-default" id="id2">
<img alt="Gravitational effect of topography" src="../../_images/sphx_glr_prisms_topo_gravity_thumb.png" />
<figcaption>
<p><span class="caption-text"><a class="reference internal" href="../../gallery/forward/prisms_topo_gravity.html#sphx-glr-gallery-forward-prisms-topo-gravity-py"><span class="std std-ref">Gravitational effect of topography</span></a></span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</div><div style='clear:both'></div></section>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="harmonica.DatasetAccessorPrismsLayer.html" class="btn btn-neutral float-right" title="harmonica.DatasetAccessorPrismsLayer" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="harmonica.tesseroid_gravity.html" class="btn btn-neutral float-left" title="harmonica.tesseroid_gravity" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018-2021, The Harmonica Developers
      <span class="lastupdated">
        Last updated on Apr 09, 2021.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>