


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    
        <title>harmonica.tesseroid_gravity &mdash; Harmonica</title>
    


  
  
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="harmonica.isostasy_airy" href="harmonica.isostasy_airy.html" />
    <link rel="prev" title="harmonica.prism_gravity" href="harmonica.prism_gravity.html" />
    <!-- Plausible analytics for anonymous usage statistics -->
    <script defer data-domain="fatiando.org" src="https://plausible.io/js/plausible.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/harmonica-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                v0.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../citing.html">Citing Harmonica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gallery/index.html">Gallery</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../sample_data/index.html">Sample Data</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#gravity-corrections">Gravity Corrections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#equivalent-layers">Equivalent Layers</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#forward-modelling">Forward modelling</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="harmonica.point_mass_gravity.html">harmonica.point_mass_gravity</a></li>
<li class="toctree-l3"><a class="reference internal" href="harmonica.prism_gravity.html">harmonica.prism_gravity</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">harmonica.tesseroid_gravity</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#examples-using-harmonica-tesseroid-gravity">Examples using <code class="docutils literal notranslate"><span class="pre">harmonica.tesseroid_gravity</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#isostasy">Isostasy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#input-and-output">Input and Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#synthetic-models-and-surveys">Synthetic models and surveys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#datasets">Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#utilities">Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../changes.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>

            
          

    
        <p class="caption">
            <span class="caption-text">
            
                Getting help and contributing
            
            </span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://www.fatiando.org"><i class="fa fa-external-link-square fa-fw"></i> Fatiando a Terra</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/fatiando/harmonica/blob/master/CONTRIBUTING.md"><i class="fa fa-users fa-fw"></i> Contributing</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/fatiando/harmonica/blob/master/CODE_OF_CONDUCT.md"><i class="fa fa-gavel fa-fw"></i> Code of Conduct</a></li>
            
                <li class="toctree-l1"><a href="http://contact.fatiando.org"><i class="fa fa-comment fa-fw"></i> Contact</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/fatiando/harmonica"><i class="fa fa-github fa-fw"></i> Source Code</a></li>
            
        </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Harmonica</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          
















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">API Reference</a> &raquo;</li>
        
      <li>harmonica.tesseroid_gravity</li>
    
    
    <li class="source-link">
        
            
                
                
                <a href="https://github.com/fatiando/harmonica/issues/new?title=Suggested%20improvement%20for%20api/generated/harmonica.tesseroid_gravity&body=Please%20describe%20what%20could%20be%20improved%20about%20this%20page%20or%20the%20typo/mistake%20that%20you%20found%3A"
                   class="fa fa-github"> Improve this page</a>
            
        
        
    </li>

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="harmonica-tesseroid-gravity">
<h1>harmonica.tesseroid_gravity<a class="headerlink" href="#harmonica-tesseroid-gravity" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="harmonica.tesseroid_gravity">
<code class="sig-prename descclassname">harmonica.</code><code class="sig-name descname">tesseroid_gravity</code><span class="sig-paren">(</span><em class="sig-param">coordinates</em>, <em class="sig-param">tesseroids</em>, <em class="sig-param">density</em>, <em class="sig-param">field</em>, <em class="sig-param">distance_size_ratii=None</em>, <em class="sig-param">glq_degrees=(2</em>, <em class="sig-param">2</em>, <em class="sig-param">2)</em>, <em class="sig-param">stack_size=100</em>, <em class="sig-param">max_discretizations=100000</em>, <em class="sig-param">radial_adaptive_discretization=False</em>, <em class="sig-param">dtype=&lt;class 'numpy.float64'&gt;</em>, <em class="sig-param">disable_checks=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/harmonica/forward/tesseroid.html#tesseroid_gravity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#harmonica.tesseroid_gravity" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute gravitational field of tesseroids on computation points.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The <code class="docutils literal notranslate"><span class="pre">g_z</span></code> field returns the downward component of the gravitational
acceleration on the local North oriented coordinate system.
It is equivalent to the opposite of the radial component, therefore
it’s positive if the acceleration vector points inside the spheroid.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coordinates</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em> or </em><em>1d-array</em>) – List or array containing <code class="docutils literal notranslate"><span class="pre">longitude</span></code>, <code class="docutils literal notranslate"><span class="pre">latitude</span></code> and <code class="docutils literal notranslate"><span class="pre">radius</span></code> of
the computation points defined on a spherical geocentric coordinate
system.
Both <code class="docutils literal notranslate"><span class="pre">longitude</span></code> and <code class="docutils literal notranslate"><span class="pre">latitude</span></code> should be in degrees and <code class="docutils literal notranslate"><span class="pre">radius</span></code>
in meters.</p></li>
<li><p><strong>tesseroids</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em> or </em><em>1d-array</em>) – List or array containing the coordinates of the tesseroid:
<code class="docutils literal notranslate"><span class="pre">w</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>, <code class="docutils literal notranslate"><span class="pre">s</span></code>, <code class="docutils literal notranslate"><span class="pre">n</span></code>, <code class="docutils literal notranslate"><span class="pre">bottom</span></code>, <code class="docutils literal notranslate"><span class="pre">top</span></code> under a geocentric
spherical coordinate system.
The longitudinal and latitudinal boundaries should be in degrees, while
the radial ones must be in meters.</p></li>
<li><p><strong>density</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em> or </em><em>array</em>) – List or array containing the density of each tesseroid in kg/m^3.</p></li>
<li><p><strong>field</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – <p>Gravitational field that wants to be computed.
The available fields are:</p>
<ul>
<li><p>Gravitational potential: <code class="docutils literal notranslate"><span class="pre">potential</span></code></p></li>
<li><p>Downward acceleration: <code class="docutils literal notranslate"><span class="pre">g_z</span></code></p></li>
</ul>
</p></li>
<li><p><strong>distance_size_ratio</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.8)"><em>None</em></a><em> (</em><em>optional</em><em>)</em>) – Dictionary containing distance-size ratii for each gravitational field
used on the adaptive discretization algorithm.
Values must be the available fields and keys should be the desired
distance-size ratio.
The greater the distance-size ratio, more discretizations will occur,
increasing the accuracy of the numerical approximation but also the
computation time.
If None, the default values of distance-size ratii will be used:
D = 1 for the potential and D = 2.5 for the gradient.
Default to None.</p></li>
<li><p><strong>glq_degrees</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em> (</em><em>optional</em><em>)</em>) – List containing the GLQ degrees used on each direction:
<code class="docutils literal notranslate"><span class="pre">glq_degree_longitude</span></code>, <code class="docutils literal notranslate"><span class="pre">glq_degree_latitude</span></code>,
<code class="docutils literal notranslate"><span class="pre">glq_degree_radius</span></code>.
The GLQ degree specifies how many point masses will be created along
each direction.
Increasing the GLQ degree will increase the accuracy of the numerical
approximation, but also the computation time.
Default <code class="docutils literal notranslate"><span class="pre">[2,</span> <span class="pre">2,</span> <span class="pre">2]</span></code>.</p></li>
<li><p><strong>stack_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em> (</em><em>optional</em><em>)</em>) – Size of the tesseroid stack used on the adaptive discretization
algorithm.
If the algorithm will perform too many splits, please increase the
stack size.</p></li>
<li><p><strong>max_discretizations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em> (</em><em>optional</em><em>)</em>) – Maximum number of splits made by the adaptive discretization algorithm.
If the algorithm will perform too many splits, please increase the
maximum number of splits.</p></li>
<li><p><strong>radial_adaptive_discretization</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code>, the adaptive discretization algorithm will split the
tesseroid only on the horizontal direction.
If <code class="docutils literal notranslate"><span class="pre">True</span></code>, it will perform a three dimensional adaptive
discretization, splitting the tesseroids on every direction.
Default <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>dtype</strong> (<em>data-type</em><em> (</em><em>optional</em><em>)</em>) – Data type assigned to the resulting gravitational field. Default to
<code class="docutils literal notranslate"><span class="pre">np.float64</span></code>.</p></li>
<li><p><strong>disable_checks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – Flag that controls whether to perform a sanity check on the model.
Should be set to <code class="docutils literal notranslate"><span class="pre">True</span></code> only when it is certain that the input model
is valid and it does not need to be checked.
Default to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong> (<em>array</em>) – Gravitational field generated by the tesseroids on the computation
points.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get WGS84 ellipsoid from the Boule package</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">boule</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ellipsoid</span> <span class="o">=</span> <span class="n">boule</span><span class="o">.</span><span class="n">WGS84</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define tesseroid of 1km of thickness with top surface on the mean</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Earth radius</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top</span> <span class="o">=</span> <span class="n">ellipsoid</span><span class="o">.</span><span class="n">mean_radius</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bottom</span> <span class="o">=</span> <span class="n">top</span> <span class="o">-</span> <span class="n">thickness</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tesseroid</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">top</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set a density of 2670 kg/m^3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span> <span class="o">=</span> <span class="mf">2670.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define computation point located on the top surface of the tesseroid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coordinates</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ellipsoid</span><span class="o">.</span><span class="n">mean_radius</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute radial component of the gravitational gradient in mGal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tesseroid_gravity</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">tesseroid</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s2">&quot;g_z&quot;</span><span class="p">)</span>
<span class="go">array(112.54539933)</span>
</pre></div>
</div>
</dd></dl>

<div class="section" id="examples-using-harmonica-tesseroid-gravity">
<h2>Examples using <code class="docutils literal notranslate"><span class="pre">harmonica.tesseroid_gravity</span></code><a class="headerlink" href="#examples-using-harmonica-tesseroid-gravity" title="Permalink to this headline">¶</a></h2>
<div class="sphx-glr-thumbcontainer" tooltip="Computing the gravitational fields generated by regional or global scale structures require to ..."><div class="figure align-default" id="id1">
<img alt="../../_images/sphx_glr_tesseroid_thumb.png" src="../../_images/sphx_glr_tesseroid_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="../../gallery/forward/tesseroid.html#sphx-glr-gallery-forward-tesseroid-py"><span class="std std-ref">Tesseroids (spherical prisms)</span></a></span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
</div><div style='clear:both'></div></div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="harmonica.isostasy_airy.html" class="btn btn-neutral float-right" title="harmonica.isostasy_airy" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="harmonica.prism_gravity.html" class="btn btn-neutral float-left" title="harmonica.prism_gravity" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018-2020, The Harmonica Developers
      <span class="lastupdated">
        Last updated on Feb 27, 2020.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>