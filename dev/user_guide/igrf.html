

<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    
        <title>IGRF calculation | Harmonica dev</title>
    

  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=cabaca87" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/igrf';</script>
    <link rel="icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="API Reference" href="../api/index.html" />
    <link rel="prev" title="Grid transformations" href="transformations.html" />
    <!-- Plausible analytics for anonymous usage statistics -->
    <script defer data-domain="fatiando.org" src="https://plausible.io/js/plausible.js"></script>

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Harmonica <span class="project-version">dev</span></p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installing</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../gallery/index.html">Gallery</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../gallery/gravity_disturbance.html">Gravity Disturbances</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/gravity_disturbance_topofree.html">Topography-free (Bouguer) Gravity Disturbances</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/isostatic_moho_airy.html">Airy Isostatic Moho</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../gallery/equivalent_sources/index.html">Equivalent Sources</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../gallery/equivalent_sources/block_averaged_sources.html">Gridding with block-averaged equivalent sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gallery/equivalent_sources/cartesian.html">Gridding and upward continuation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gallery/equivalent_sources/gradient_boosted.html">Gradient-boosted equivalent sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gallery/equivalent_sources/spherical.html">Gridding in spherical coordinates</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../gallery/forward/index.html">Forward Modeling</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../gallery/forward/point_gravity.html">Point Masses in Cartesian Coordinates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gallery/forward/prism_layer.html">Layer of prisms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gallery/forward/prisms_topo_gravity.html">Gravitational effect of topography</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gallery/forward/tesseroid.html">Tesseroids (spherical prisms)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gallery/forward/tesseroid_layer.html">Layer of tesseroids</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gallery/forward/tesseroid_variable_density.html">Tesseroids with variable density</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../gallery/transformations/index.html">Grid transformations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../gallery/transformations/reduction_to_pole.html">Reduction to the pole of a magnetic anomaly grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gallery/transformations/tga.html">Total gradient amplitude of a regular grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gallery/transformations/tilt.html">Tilt of a regular grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gallery/transformations/upward_continuation.html">Upward continuation of a regular grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gallery/transformations/upward_derivative.html">Upward derivative of a regular grid</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../gallery/visualization/index.html">3D visualizations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../gallery/visualization/prism_layer_pyvista.html">Plot a prism layer in 3D</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="coordinate_systems.html">Coordinate systems</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="forward_modelling/index.html">Forward modelling</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="forward_modelling/point.html">Point sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="forward_modelling/dipole.html">Magnetic dipoles</a></li>
<li class="toctree-l2"><a class="reference internal" href="forward_modelling/prism.html">Rectangular prisms</a></li>
<li class="toctree-l2"><a class="reference internal" href="forward_modelling/tesseroid.html">Tesseroids</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="gravity_disturbance.html">Gravity Disturbance</a></li>
<li class="toctree-l1"><a class="reference internal" href="topographic_correction.html">Topographic Correction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="equivalent_sources/index.html">Equivalent Sources</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="equivalent_sources/eqs-parameters-estimation.html">Estimating damping and depth parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="equivalent_sources/block-averaged-eqs.html">Block-averaged equivalent sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="equivalent_sources/gradient-boosted-eqs.html">Gradient-boosted equivalent sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="equivalent_sources/eq-sources-spherical.html">Equivalent sources in spherical coordinates</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="transformations.html">Grid transformations</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">IGRF calculation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference documentation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">API Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.bouguer_correction.html">harmonica.bouguer_correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.derivative_easting.html">harmonica.derivative_easting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.derivative_northing.html">harmonica.derivative_northing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.derivative_upward.html">harmonica.derivative_upward</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.upward_continuation.html">harmonica.upward_continuation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.gaussian_lowpass.html">harmonica.gaussian_lowpass</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.gaussian_highpass.html">harmonica.gaussian_highpass</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.reduction_to_pole.html">harmonica.reduction_to_pole</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.total_gradient_amplitude.html">harmonica.total_gradient_amplitude</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.tilt_angle.html">harmonica.tilt_angle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.filters.derivative_easting_kernel.html">harmonica.filters.derivative_easting_kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.filters.derivative_northing_kernel.html">harmonica.filters.derivative_northing_kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.filters.derivative_upward_kernel.html">harmonica.filters.derivative_upward_kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.filters.upward_continuation_kernel.html">harmonica.filters.upward_continuation_kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.filters.gaussian_lowpass_kernel.html">harmonica.filters.gaussian_lowpass_kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.filters.gaussian_highpass_kernel.html">harmonica.filters.gaussian_highpass_kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.filters.reduction_to_pole_kernel.html">harmonica.filters.reduction_to_pole_kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.EquivalentSources.html">harmonica.EquivalentSources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.EquivalentSourcesGB.html">harmonica.EquivalentSourcesGB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.EquivalentSourcesSph.html">harmonica.EquivalentSourcesSph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.ellipsoid_gravity.html">harmonica.ellipsoid_gravity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.point_gravity.html">harmonica.point_gravity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.prism_gravity.html">harmonica.prism_gravity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.tesseroid_gravity.html">harmonica.tesseroid_gravity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.dipole_magnetic.html">harmonica.dipole_magnetic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.ellipsoid_magnetic.html">harmonica.ellipsoid_magnetic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.prism_magnetic.html">harmonica.prism_magnetic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.Ellipsoid.html">harmonica.Ellipsoid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.prism_layer.html">harmonica.prism_layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.tesseroid_layer.html">harmonica.tesseroid_layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.DatasetAccessorPrismLayer.html">harmonica.DatasetAccessorPrismLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.DatasetAccessorTesseroidLayer.html">harmonica.DatasetAccessorTesseroidLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.isostatic_moho_airy.html">harmonica.isostatic_moho_airy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.EulerDeconvolution.html">harmonica.EulerDeconvolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.IGRF14.html">harmonica.IGRF14</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.load_icgem_gdf.html">harmonica.load_icgem_gdf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.load_oasis_montaj_grid.html">harmonica.load_oasis_montaj_grid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.visualization.prism_to_pyvista.html">harmonica.visualization.prism_to_pyvista</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.magnetic_vec_to_angles.html">harmonica.magnetic_vec_to_angles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.magnetic_angles_to_vec.html">harmonica.magnetic_angles_to_vec</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.total_field_anomaly.html">harmonica.total_field_anomaly</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.errors.NoPhysicalPropertyWarning.html">harmonica.errors.NoPhysicalPropertyWarning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/harmonica.typing.Coordinates.html">harmonica.typing.Coordinates</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">Citing Harmonica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changes.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compatibility.html">Version compatibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="../versions.html">Documentation for other versions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://www.fatiando.org/contact">Join the community</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/fatiando/harmonica/blob/main/CONTRIBUTING.md">How to contribute</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/fatiando/community/blob/main/CODE_OF_CONDUCT.md">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/fatiando/harmonica">Source code on GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.fatiando.org">The Fatiando a Terra project</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/fatiando/harmonica" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/fatiando/harmonica/edit/main/doc/user_guide/igrf.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/fatiando/harmonica/issues/new?title=Issue%20on%20page%20%2Fuser_guide/igrf.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/user_guide/igrf.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>IGRF calculation</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-at-given-points">Calculating at given points</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#changing-the-reference-ellipsoid">Changing the reference ellipsoid</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generating-a-grid">Generating a grid</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="igrf-calculation">
<h1>IGRF calculation<a class="headerlink" href="#igrf-calculation" title="Link to this heading">#</a></h1>
<p>The International Geomagnetic Reference Field (IGRF) is time-variable spherical
harmonic model of the Earth’s internal magnetic field <a class="reference internal" href="../references.html#alken2021" id="id1"><span>[Alken2021]</span></a> <a class="reference internal" href="../references.html#iaga2024" id="id2"><span>[IAGA2024]</span></a>.
The model is released every 5 years and allows us to calculate the internal
magnetic field from 1900 until 5 years after the latest release (based on
predictions of the secular variation). Harmonica allows calculating the 14th
generation IGRF field with <a class="reference internal" href="../api/generated/harmonica.IGRF14.html#harmonica.IGRF14" title="harmonica.IGRF14"><code class="xref py py-class docutils literal notranslate"><span class="pre">harmonica.IGRF14</span></code></a>. Here’s how it works.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pygmt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">boule</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">bl</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">harmonica</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">hm</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>All of the functionality is wrapped in the <a class="reference internal" href="../api/generated/harmonica.IGRF14.html#harmonica.IGRF14" title="harmonica.IGRF14"><code class="xref py py-class docutils literal notranslate"><span class="pre">IGRF14</span></code></a> class.
When creating an instance of it, we need to provide the date on which we want
to calculate the field:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">igrf</span> <span class="o">=</span> <span class="n">hm</span><span class="o">.</span><span class="n">IGRF14</span><span class="p">(</span><span class="s2">&quot;1954-07-29&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>The date can be provided as an <a class="reference external" href="https://en.wikipedia.org/wiki/ISO_8601">ISO 8601 formatted date</a> string like above or as a Python
<a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.datetime</span></code></a>:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">igrf</span> <span class="o">=</span> <span class="n">hm</span><span class="o">.</span><span class="n">IGRF14</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1954</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="n">hour</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">minute</span><span class="o">=</span><span class="mi">20</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the time is omited, the default is midnight. If a timezone is omited, the
default is UTC.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Typically, for a short magnetometry survey (a few days to a week), using
a single time for calculating the IGRF is adequate, since IGRF secular
variations on these time scales are typically small. However, if the survey
is longer, or high precision is required, it may be best to separate the
survey by days or flights and calculate the IGRF using a more appropriate
datetime for each section.</p>
</div>
<section id="calculating-at-given-points">
<h2>Calculating at given points<a class="headerlink" href="#calculating-at-given-points" title="Link to this heading">#</a></h2>
<p>To calculate the IGRF field at a particular point or set of points, we can use
the <a class="reference internal" href="../api/generated/harmonica.IGRF14.html#harmonica.IGRF14.predict" title="harmonica.IGRF14.predict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">harmonica.IGRF14.predict</span></code></a> method. For example, let’s calculate the
field on the date above at the <a class="reference external" href="https://www5.usp.br/">Universidade de São Paulo</a> campus. To do so, we need to provide the geodetic
coordinates longitude, latitude, and geometric height (in meters) of the
calculation point in that order:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field</span> <span class="o">=</span> <span class="n">igrf</span><span class="o">.</span><span class="n">predict</span><span class="p">((</span><span class="o">-</span><span class="mf">46.73441817537987</span><span class="p">,</span> <span class="o">-</span><span class="mf">23.559276852800025</span><span class="p">,</span> <span class="mi">700</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>(-5120.730455904012, 22239.393240125162, 8754.879929493665)
</pre></div>
</div>
</div>
</div>
<p>The return value <code class="docutils literal notranslate"><span class="pre">field</span></code> will always be a tuple with the eastward, northward,
and upward components of the magnetic field. The vector is in a geodetic
coordinate system with the horizontal (eastward and northward) directions
parallel to the surface of the ellipsoid and the upward direction parallel to
the ellipsoid normal at each given point.</p>
<p>We can print the results in a better way to view them:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Be=</span><span class="si">{</span><span class="n">field</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> nT | Bn=</span><span class="si">{</span><span class="n">field</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> nT | Bu=</span><span class="si">{</span><span class="n">field</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> nT&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Be=-5120.7 nT | Bn=22239.4 nT | Bu=8754.9 nT
</pre></div>
</div>
</div>
</div>
<p>We can convert this tuple of values into intensity (or amplitude), inclination and
declination using
<a class="reference internal" href="../api/generated/harmonica.magnetic_vec_to_angles.html#harmonica.magnetic_vec_to_angles" title="harmonica.magnetic_vec_to_angles"><code class="xref py py-func docutils literal notranslate"><span class="pre">harmonica.magnetic_vec_to_angles</span></code></a>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">intensity</span><span class="p">,</span> <span class="n">inc</span><span class="p">,</span> <span class="n">dec</span> <span class="o">=</span> <span class="n">hm</span><span class="o">.</span><span class="n">magnetic_vec_to_angles</span><span class="p">(</span><span class="o">*</span><span class="n">field</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">intensity</span><span class="si">=:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> nT | </span><span class="si">{</span><span class="n">inc</span><span class="si">=:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">° | </span><span class="si">{</span><span class="n">dec</span><span class="si">=:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">°&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>intensity=24443.0 nT | inc=-21.0° | dec=-13.0°
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While the vertical component of the magnetic field (<span class="math notranslate nohighlight">\(B_u\)</span>) is positive
upward, the inclination is positive downward as per international
convention. Hence why the value above is negative.</p>
</div>
<p>In addition to calculating the IGRF field at one location, multiple coordinates
can be given as numpy arrays or lists:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field</span> <span class="o">=</span> <span class="n">igrf</span><span class="o">.</span><span class="n">predict</span><span class="p">((</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">46.73441817537987</span><span class="p">,</span> <span class="o">-</span><span class="mf">157.81633280370718</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">23.559276852800025</span><span class="p">,</span> <span class="mf">21.297542396621708</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">700</span><span class="p">,</span> <span class="mi">80</span><span class="p">],</span>
<span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>(array([-5120.7304559 ,  5569.26432127]), array([22239.39324013, 27863.10882347]), array([  8754.87992949, -22952.79770157]))
</pre></div>
</div>
</div>
</div>
<p>The resulting components will be numpy arrays with a shape that matches the
shape of the coordinates.</p>
</section>
<section id="changing-the-reference-ellipsoid">
<h2>Changing the reference ellipsoid<a class="headerlink" href="#changing-the-reference-ellipsoid" title="Link to this heading">#</a></h2>
<p>The actual calculations (see the notes in <a class="reference internal" href="../api/generated/harmonica.IGRF14.html#harmonica.IGRF14" title="harmonica.IGRF14"><code class="xref py py-class docutils literal notranslate"><span class="pre">harmonica.IGRF14</span></code></a>) are
performed in geocentric spherical coordinates. This means that the input
coordinates must be converted from a geodetic system (which is what most data
will come in) to a geocentric system and the output vector must be rotated back
to the geodetic system. We use the ellipsoids in <a class="reference external" href="https://www.fatiando.org/boule/latest/api/index.html#module-boule" title="(in Boule vv0.5.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">boule</span></code></a> to
handle these conversions. By default, we use the WGS84 ellipsoid but you can
pass other Boule ellipsoids (or make your own with <a class="reference external" href="https://www.fatiando.org/boule/latest/api/generated/boule.Ellipsoid.html#boule.Ellipsoid" title="(in Boule vv0.5.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">boule.Ellipsoid</span></code></a>):</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">igrf_grs80</span> <span class="o">=</span> <span class="n">hm</span><span class="o">.</span><span class="n">IGRF14</span><span class="p">(</span><span class="s2">&quot;1954-07-29&quot;</span><span class="p">,</span> <span class="n">ellipsoid</span><span class="o">=</span><span class="n">bl</span><span class="o">.</span><span class="n">GRS80</span><span class="p">)</span>
<span class="n">field</span> <span class="o">=</span> <span class="n">igrf_grs80</span><span class="o">.</span><span class="n">predict</span><span class="p">((</span><span class="o">-</span><span class="mf">46.73441817537987</span><span class="p">,</span> <span class="o">-</span><span class="mf">23.559276852800025</span><span class="p">,</span> <span class="mi">700</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>(-5120.723844237039, 22239.4027452013, 8754.87004402814)
</pre></div>
</div>
</div>
</div>
<p>Notice that the field values are slightly different. So it can be important
that the ellipsoid passed to the class is the one used for your coordinates.</p>
</section>
<section id="generating-a-grid">
<h2>Generating a grid<a class="headerlink" href="#generating-a-grid" title="Link to this heading">#</a></h2>
<p>If we want to make a grid of the IGRF values, we could create grid coordinates
and pass them to the <a class="reference internal" href="../api/generated/harmonica.IGRF14.html#harmonica.IGRF14.predict" title="harmonica.IGRF14.predict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">predict</span></code></a> method. However, there
are certain repeated operations that can be avoided when we know we’re
calculating on a grid. Plus, it would be good to have the results in
a <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.2.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a> that carried all of the associated metadata.</p>
<p>That’s what the <a class="reference internal" href="../api/generated/harmonica.IGRF14.html#harmonica.IGRF14.grid" title="harmonica.IGRF14.grid"><code class="xref py py-meth docutils literal notranslate"><span class="pre">harmonica.IGRF14.grid</span></code></a> method is for! Calculations with
it will be at least 2x faster than using <a class="reference internal" href="../api/generated/harmonica.IGRF14.html#harmonica.IGRF14.predict" title="harmonica.IGRF14.predict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">predict</span></code></a> and
it packages the results in a <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.2.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a> full of metadata:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">igrf</span> <span class="o">=</span> <span class="n">hm</span><span class="o">.</span><span class="n">IGRF14</span><span class="p">(</span><span class="s2">&quot;2020-02-27&quot;</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">igrf</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">),</span> <span class="n">height</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">grid</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in notebooks */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
  line-height: 1.6;
  padding-bottom: 4px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
}

.xr-header {
  border-bottom: solid 1px var(--xr-border-color);
  margin-bottom: 4px;
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-obj-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type,
.xr-group-box-contents > label {
  color: var(--xr-font-color2);
  display: block;
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
  margin-block-start: 0;
  margin-block-end: 0;
}

.xr-section-item {
  display: contents;
}

.xr-section-item > input,
.xr-group-box-contents > input,
.xr-array-wrap > input {
  display: block;
  opacity: 0;
  height: 0;
  margin: 0;
}

.xr-section-item > input + label,
.xr-var-item > input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item > input:enabled + label,
.xr-var-item > input:enabled + label,
.xr-array-wrap > input:enabled + label,
.xr-group-box-contents > input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item > input:focus-visible + label,
.xr-var-item > input:focus-visible + label,
.xr-array-wrap > input:focus-visible + label,
.xr-group-box-contents > input:focus-visible + label {
  outline: auto;
}

.xr-section-item > input:enabled + label:hover,
.xr-var-item > input:enabled + label:hover,
.xr-array-wrap > input:enabled + label:hover,
.xr-group-box-contents > input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
  white-space: nowrap;
}

.xr-section-summary > em {
  font-weight: normal;
}

.xr-span-grid {
  grid-column-end: -1;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.3em;
}

.xr-group-box-contents > input:checked + label > span {
  display: inline-block;
  padding-left: 0.6em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details,
.xr-group-box-contents > label {
  padding-top: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  grid-column: 1 / -1;
  margin-top: 4px;
  margin-bottom: 5px;
}

.xr-section-summary-in ~ .xr-section-details {
  display: none;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-children {
  display: inline-grid;
  grid-template-columns: 100%;
  grid-column: 1 / -1;
  padding-top: 4px;
}

.xr-group-box {
  display: inline-grid;
  grid-template-columns: 0px 30px auto;
}

.xr-group-box-vline {
  grid-column-start: 1;
  border-right: 0.2em solid;
  border-color: var(--xr-border-color);
  width: 0px;
}

.xr-group-box-hline {
  grid-column-start: 2;
  grid-row-start: 1;
  height: 1em;
  width: 26px;
  border-bottom: 0.2em solid;
  border-color: var(--xr-border-color);
}

.xr-group-box-contents {
  grid-column-start: 3;
  padding-bottom: 4px;
}

.xr-group-box-contents > label::before {
  content: "📂";
  padding-right: 0.3em;
}

.xr-group-box-contents > input:checked + label::before {
  content: "📁";
}

.xr-group-box-contents > input:checked + label {
  padding-bottom: 0px;
}

.xr-group-box-contents > input:checked ~ .xr-sections {
  display: none;
}

.xr-group-box-contents > input + label > span {
  display: none;
}

.xr-group-box-ellipsis {
  font-size: 1.4em;
  font-weight: 900;
  color: var(--xr-font-color2);
  letter-spacing: 0.15em;
  cursor: default;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 54kB
Dimensions:    (latitude: 29, longitude: 57)
Coordinates:
  * latitude   (latitude) float64 232B -90.0 -83.57 -77.14 ... 77.14 83.57 90.0
  * longitude  (longitude) float64 456B 0.0 6.429 12.86 ... 347.1 353.6 360.0
    height     (latitude, longitude) float64 13kB 0.0 0.0 0.0 ... 0.0 0.0 0.0
Data variables:
    b_east     (latitude, longitude) float64 13kB 0.0 0.0 0.0 ... 0.0 0.0 0.0
    b_north    (latitude, longitude) float64 13kB 1.443e+04 ... 1.814e+03
    b_up       (latitude, longitude) float64 13kB 5.202e+04 ... -5.673e+04
Attributes:
    Conventions:  CF-1.8
    title:        IGRF14 magnetic field on 2020-02-27T00:00:00
    crs:          WGS84
    source:       Generated by spherical harmonic synthesis using library Har...
    description:  Three components of the magnetic field vector calculated on...
    units:        nT
    date:         2020-02-27T00:00:00
    references:   https://doi.org/10.5281/zenodo.14218973</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-36485cc1-16e8-444c-9878-4b00d0aaa858' class='xr-section-summary-in' type='checkbox' disabled /><label for='section-36485cc1-16e8-444c-9878-4b00d0aaa858' class='xr-section-summary'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 29</li><li><span class='xr-has-index'>longitude</span>: 57</li></ul></div></li><li class='xr-section-item'><input id='section-e28eb688-2405-40a8-8a7f-79ad372bce1a' class='xr-section-summary-in' type='checkbox' checked /><label for='section-e28eb688-2405-40a8-8a7f-79ad372bce1a' class='xr-section-summary' title='Expand/collapse section'>Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-90.0 -83.57 -77.14 ... 83.57 90.0</div><input id='attrs-36fca7c9-c8b2-4c57-ac8f-853d17f212da' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-36fca7c9-c8b2-4c57-ac8f-853d17f212da' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-54a07ce2-81f5-4219-8a15-f505e0da5dc5' class='xr-var-data-in' type='checkbox'><label for='data-54a07ce2-81f5-4219-8a15-f505e0da5dc5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>actual_range :</span></dt><dd>(-90.0, 90.0)</dd></dl></div><div class='xr-var-data'><pre>array([-90.      , -83.571429, -77.142857, -70.714286, -64.285714, -57.857143,
       -51.428571, -45.      , -38.571429, -32.142857, -25.714286, -19.285714,
       -12.857143,  -6.428571,   0.      ,   6.428571,  12.857143,  19.285714,
        25.714286,  32.142857,  38.571429,  45.      ,  51.428571,  57.857143,
        64.285714,  70.714286,  77.142857,  83.571429,  90.      ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 6.429 12.86 ... 353.6 360.0</div><input id='attrs-20b6f338-83d8-4c7f-b587-09c7fb9654d9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-20b6f338-83d8-4c7f-b587-09c7fb9654d9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-35c3daea-e7a7-4599-a4b5-01a049dec43d' class='xr-var-data-in' type='checkbox'><label for='data-35c3daea-e7a7-4599-a4b5-01a049dec43d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>actual_range :</span></dt><dd>(0.0, 360.0)</dd></dl></div><div class='xr-var-data'><pre>array([  0.      ,   6.428571,  12.857143,  19.285714,  25.714286,  32.142857,
        38.571429,  45.      ,  51.428571,  57.857143,  64.285714,  70.714286,
        77.142857,  83.571429,  90.      ,  96.428571, 102.857143, 109.285714,
       115.714286, 122.142857, 128.571429, 135.      , 141.428571, 147.857143,
       154.285714, 160.714286, 167.142857, 173.571429, 180.      , 186.428571,
       192.857143, 199.285714, 205.714286, 212.142857, 218.571429, 225.      ,
       231.428571, 237.857143, 244.285714, 250.714286, 257.142857, 263.571429,
       270.      , 276.428571, 282.857143, 289.285714, 295.714286, 302.142857,
       308.571429, 315.      , 321.428571, 327.857143, 334.285714, 340.714286,
       347.142857, 353.571429, 360.      ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>height</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0</div><input id='attrs-9b4d82aa-e0a6-4b96-bc17-e81009e66303' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9b4d82aa-e0a6-4b96-bc17-e81009e66303' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d0e50dbb-0ddd-4249-b6c5-8d190db792da' class='xr-var-data-in' type='checkbox'><label for='data-d0e50dbb-0ddd-4249-b6c5-8d190db792da' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>geometric height</dd><dt><span>standard_name :</span></dt><dd>height_above_reference_ellipsoid</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>array([[0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       ...,
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.]], shape=(29, 57))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0a81d4e2-5444-4edd-8665-9430522c340b' class='xr-section-summary-in' type='checkbox' checked /><label for='section-0a81d4e2-5444-4edd-8665-9430522c340b' class='xr-section-summary' title='Expand/collapse section'>Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>b_east</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0</div><input id='attrs-12ddb5f7-b737-4497-bcef-03b886b71303' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-12ddb5f7-b737-4497-bcef-03b886b71303' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8d075e99-c981-4743-ac90-4b50e8c6b03c' class='xr-var-data-in' type='checkbox'><label for='data-8d075e99-c981-4743-ac90-4b50e8c6b03c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>nT</dd><dt><span>long_name :</span></dt><dd>Eastward component</dd><dt><span>description :</span></dt><dd>Eastward component of the magnetic field vector calculated on 2020-02-27T00:00:00</dd></dl></div><div class='xr-var-data'><pre>array([[     0.        ,      0.        ,      0.        , ...,
             0.        ,      0.        ,      0.        ],
       [ -7911.36292143,  -9508.44965207, -11016.16180134, ...,
         -4532.37889404,  -6246.04766156,  -7911.36292143],
       [ -7226.55058324,  -8780.79803058, -10301.57500089, ...,
         -4089.17317548,  -5658.28956681,  -7226.55058324],
       ...,
       [  -225.18480663,    416.10180898,   1045.8963174 , ...,
         -1459.98551346,   -857.42981968,   -225.18480663],
       [   -27.93248264,    426.61970419,    872.13798283, ...,
          -906.52055564,   -477.02873534,    -27.93248264],
       [     0.        ,      0.        ,      0.        , ...,
             0.        ,      0.        ,      0.        ]],
      shape=(29, 57))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>b_north</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.443e+04 1.338e+04 ... 1.814e+03</div><input id='attrs-fc5f7c06-f814-42eb-a8bb-11c86632bec9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fc5f7c06-f814-42eb-a8bb-11c86632bec9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-97ceaaab-268b-4b7a-b8ac-af839ecddf5d' class='xr-var-data-in' type='checkbox'><label for='data-97ceaaab-268b-4b7a-b8ac-af839ecddf5d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>nT</dd><dt><span>long_name :</span></dt><dd>Northward component</dd><dt><span>description :</span></dt><dd>Northward component of the magnetic field vector calculated on 2020-02-27T00:00:00</dd></dl></div><div class='xr-var-data'><pre>array([[14428.0874136 , 13377.27284693, 12158.23131254, ...,
        15974.4589653 , 15297.46040968, 14428.0874136 ],
       [16897.83003364, 16002.81709588, 14932.51795662, ...,
        18150.28187853, 17614.12457548, 16897.83003364],
       [17862.91277114, 17150.19390643, 16279.05302268, ...,
        18859.19108765, 18428.60145511, 17862.91277114],
       ...,
       [ 7813.94947223,  7825.18964951,  7734.75397221, ...,
         7486.15043186,  7700.23023846,  7813.94947223],
       [ 4967.72702182,  4955.64043291,  4868.13664353, ...,
         4768.63646327,  4904.48019991,  4967.72702182],
       [ 1814.03297877,  1787.35772407,  1738.20540893, ...,
         1798.89736031,  1817.89571624,  1814.03297877]], shape=(29, 57))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>b_up</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.202e+04 5.202e+04 ... -5.673e+04</div><input id='attrs-8e58c586-c0d7-4f0c-b23b-b28f63e7d305' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8e58c586-c0d7-4f0c-b23b-b28f63e7d305' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-67df9a3d-d204-4910-873a-b4633e3f2091' class='xr-var-data-in' type='checkbox'><label for='data-67df9a3d-d204-4910-873a-b4633e3f2091' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>nT</dd><dt><span>long_name :</span></dt><dd>Upward component</dd><dt><span>description :</span></dt><dd>Upward component of the magnetic field vector calculated on 2020-02-27T00:00:00</dd></dl></div><div class='xr-var-data'><pre>array([[ 52015.22218322,  52015.22218322,  52015.22218322, ...,
         52015.22218322,  52015.22218322,  52015.22218322],
       [ 45799.90109471,  46011.57413754,  46297.43466759, ...,
         45600.53023394,  45663.00182906,  45799.90109471],
       [ 39344.07276642,  39692.74858434,  40188.08884868, ...,
         39061.55632411,  39136.11339031,  39344.07276642],
       ...,
       [-53904.58548137, -53989.21603051, -54145.34968525, ...,
        -53944.1524412 , -53890.51295485, -53904.58548137],
       [-55445.94473645, -55508.11189082, -55597.02987442, ...,
        -55402.03166929, -55410.76565644, -55445.94473645],
       [-56731.72681549, -56731.72681549, -56731.72681549, ...,
        -56731.72681549, -56731.72681549, -56731.72681549]],
      shape=(29, 57))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d1cde37c-5c75-47c4-b869-6502824d2690' class='xr-section-summary-in' type='checkbox' checked /><label for='section-d1cde37c-5c75-47c4-b869-6502824d2690' class='xr-section-summary' title='Expand/collapse section'>Attributes: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.8</dd><dt><span>title :</span></dt><dd>IGRF14 magnetic field on 2020-02-27T00:00:00</dd><dt><span>crs :</span></dt><dd>WGS84</dd><dt><span>source :</span></dt><dd>Generated by spherical harmonic synthesis using library Harmonica (fatiando.org/harmonica) version 0.7.0.post79+g352418b98.</dd><dt><span>description :</span></dt><dd>Three components of the magnetic field vector calculated on 2020-02-27T00:00:00 in a geodetic coordinate system.</dd><dt><span>units :</span></dt><dd>nT</dd><dt><span>date :</span></dt><dd>2020-02-27T00:00:00</dd><dt><span>references :</span></dt><dd>https://doi.org/10.5281/zenodo.14218973</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>We can plot the three components using <code class="xref py py-mod docutils literal notranslate"><span class="pre">pygmt</span></code> on a nice map:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">pygmt</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;b_east&quot;</span><span class="p">,</span> <span class="s2">&quot;b_north&quot;</span><span class="p">,</span> <span class="s2">&quot;b_up&quot;</span><span class="p">]:</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">grdimage</span><span class="p">(</span>
        <span class="n">grid</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;polar+h&quot;</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;W15c&quot;</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">coast</span><span class="p">(</span><span class="n">shorelines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
        <span class="n">position</span><span class="o">=</span><span class="s2">&quot;JMR+ml+o0.5c&quot;</span><span class="p">,</span>
        <span class="n">frame</span><span class="o">=</span><span class="p">[</span>
            <span class="s2">&quot;a10000&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;x+l</span><span class="si">{</span><span class="n">grid</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;y+l</span><span class="si">{</span><span class="n">grid</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;b_east&quot;</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">basemap</span><span class="p">(</span><span class="n">frame</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;+t</span><span class="si">{</span><span class="n">grid</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">basemap</span><span class="p">(</span><span class="n">frame</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">shift_origin</span><span class="p">(</span><span class="n">yshift</span><span class="o">=</span><span class="s2">&quot;-h-0.5c&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/igrf_9_0.png" src="../_images/igrf_9_0.png" />
</div>
</div>
<p>The grid spacing was calculated automatically to match the maximum degree of
the spherical harmonic expansion (default is 13). It can also be adjusted by
passing the <code class="docutils literal notranslate"><span class="pre">spacing</span></code> or <code class="docutils literal notranslate"><span class="pre">shape</span></code> arguments. For example, let’s set the
spacing to 1 degree:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">igrf</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">),</span> <span class="n">height</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">grid</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in notebooks */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
  line-height: 1.6;
  padding-bottom: 4px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
}

.xr-header {
  border-bottom: solid 1px var(--xr-border-color);
  margin-bottom: 4px;
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-obj-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type,
.xr-group-box-contents > label {
  color: var(--xr-font-color2);
  display: block;
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
  margin-block-start: 0;
  margin-block-end: 0;
}

.xr-section-item {
  display: contents;
}

.xr-section-item > input,
.xr-group-box-contents > input,
.xr-array-wrap > input {
  display: block;
  opacity: 0;
  height: 0;
  margin: 0;
}

.xr-section-item > input + label,
.xr-var-item > input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item > input:enabled + label,
.xr-var-item > input:enabled + label,
.xr-array-wrap > input:enabled + label,
.xr-group-box-contents > input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item > input:focus-visible + label,
.xr-var-item > input:focus-visible + label,
.xr-array-wrap > input:focus-visible + label,
.xr-group-box-contents > input:focus-visible + label {
  outline: auto;
}

.xr-section-item > input:enabled + label:hover,
.xr-var-item > input:enabled + label:hover,
.xr-array-wrap > input:enabled + label:hover,
.xr-group-box-contents > input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
  white-space: nowrap;
}

.xr-section-summary > em {
  font-weight: normal;
}

.xr-span-grid {
  grid-column-end: -1;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.3em;
}

.xr-group-box-contents > input:checked + label > span {
  display: inline-block;
  padding-left: 0.6em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details,
.xr-group-box-contents > label {
  padding-top: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  grid-column: 1 / -1;
  margin-top: 4px;
  margin-bottom: 5px;
}

.xr-section-summary-in ~ .xr-section-details {
  display: none;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-children {
  display: inline-grid;
  grid-template-columns: 100%;
  grid-column: 1 / -1;
  padding-top: 4px;
}

.xr-group-box {
  display: inline-grid;
  grid-template-columns: 0px 30px auto;
}

.xr-group-box-vline {
  grid-column-start: 1;
  border-right: 0.2em solid;
  border-color: var(--xr-border-color);
  width: 0px;
}

.xr-group-box-hline {
  grid-column-start: 2;
  grid-row-start: 1;
  height: 1em;
  width: 26px;
  border-bottom: 0.2em solid;
  border-color: var(--xr-border-color);
}

.xr-group-box-contents {
  grid-column-start: 3;
  padding-bottom: 4px;
}

.xr-group-box-contents > label::before {
  content: "📂";
  padding-right: 0.3em;
}

.xr-group-box-contents > input:checked + label::before {
  content: "📁";
}

.xr-group-box-contents > input:checked + label {
  padding-bottom: 0px;
}

.xr-group-box-contents > input:checked ~ .xr-sections {
  display: none;
}

.xr-group-box-contents > input + label > span {
  display: none;
}

.xr-group-box-ellipsis {
  font-size: 1.4em;
  font-weight: 900;
  color: var(--xr-font-color2);
  letter-spacing: 0.15em;
  cursor: default;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 2MB
Dimensions:    (latitude: 181, longitude: 361)
Coordinates:
  * latitude   (latitude) float64 1kB -90.0 -89.0 -88.0 -87.0 ... 88.0 89.0 90.0
  * longitude  (longitude) float64 3kB 0.0 1.0 2.0 3.0 ... 358.0 359.0 360.0
    height     (latitude, longitude) float64 523kB 0.0 0.0 0.0 ... 0.0 0.0 0.0
Data variables:
    b_east     (latitude, longitude) float64 523kB 0.0 0.0 0.0 ... 0.0 0.0 0.0
    b_north    (latitude, longitude) float64 523kB 1.443e+04 ... 1.814e+03
    b_up       (latitude, longitude) float64 523kB 5.202e+04 ... -5.673e+04
Attributes:
    Conventions:  CF-1.8
    title:        IGRF14 magnetic field on 2020-02-27T00:00:00
    crs:          WGS84
    source:       Generated by spherical harmonic synthesis using library Har...
    description:  Three components of the magnetic field vector calculated on...
    units:        nT
    date:         2020-02-27T00:00:00
    references:   https://doi.org/10.5281/zenodo.14218973</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-2dc94358-3921-4140-a055-b070342d268d' class='xr-section-summary-in' type='checkbox' disabled /><label for='section-2dc94358-3921-4140-a055-b070342d268d' class='xr-section-summary'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 181</li><li><span class='xr-has-index'>longitude</span>: 361</li></ul></div></li><li class='xr-section-item'><input id='section-d337145d-918d-4c13-89e3-0d861ec7f7a5' class='xr-section-summary-in' type='checkbox' checked /><label for='section-d337145d-918d-4c13-89e3-0d861ec7f7a5' class='xr-section-summary' title='Expand/collapse section'>Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-90.0 -89.0 -88.0 ... 89.0 90.0</div><input id='attrs-21e4e70b-8d74-498f-ae9f-656d59ea0f8b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-21e4e70b-8d74-498f-ae9f-656d59ea0f8b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8a3f8800-e5b3-446f-9eab-04e806dd24d8' class='xr-var-data-in' type='checkbox'><label for='data-8a3f8800-e5b3-446f-9eab-04e806dd24d8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>actual_range :</span></dt><dd>(-90.0, 90.0)</dd></dl></div><div class='xr-var-data'><pre>array([-90., -89., -88., -87., -86., -85., -84., -83., -82., -81., -80., -79.,
       -78., -77., -76., -75., -74., -73., -72., -71., -70., -69., -68., -67.,
       -66., -65., -64., -63., -62., -61., -60., -59., -58., -57., -56., -55.,
       -54., -53., -52., -51., -50., -49., -48., -47., -46., -45., -44., -43.,
       -42., -41., -40., -39., -38., -37., -36., -35., -34., -33., -32., -31.,
       -30., -29., -28., -27., -26., -25., -24., -23., -22., -21., -20., -19.,
       -18., -17., -16., -15., -14., -13., -12., -11., -10.,  -9.,  -8.,  -7.,
        -6.,  -5.,  -4.,  -3.,  -2.,  -1.,   0.,   1.,   2.,   3.,   4.,   5.,
         6.,   7.,   8.,   9.,  10.,  11.,  12.,  13.,  14.,  15.,  16.,  17.,
        18.,  19.,  20.,  21.,  22.,  23.,  24.,  25.,  26.,  27.,  28.,  29.,
        30.,  31.,  32.,  33.,  34.,  35.,  36.,  37.,  38.,  39.,  40.,  41.,
        42.,  43.,  44.,  45.,  46.,  47.,  48.,  49.,  50.,  51.,  52.,  53.,
        54.,  55.,  56.,  57.,  58.,  59.,  60.,  61.,  62.,  63.,  64.,  65.,
        66.,  67.,  68.,  69.,  70.,  71.,  72.,  73.,  74.,  75.,  76.,  77.,
        78.,  79.,  80.,  81.,  82.,  83.,  84.,  85.,  86.,  87.,  88.,  89.,
        90.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 1.0 2.0 ... 358.0 359.0 360.0</div><input id='attrs-8ae5fbfa-2a3b-4802-b921-ab3735d9880c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8ae5fbfa-2a3b-4802-b921-ab3735d9880c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1cdc84b2-c1af-4130-a460-83f4e0302de0' class='xr-var-data-in' type='checkbox'><label for='data-1cdc84b2-c1af-4130-a460-83f4e0302de0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>actual_range :</span></dt><dd>(0.0, 360.0)</dd></dl></div><div class='xr-var-data'><pre>array([  0.,   1.,   2., ..., 358., 359., 360.], shape=(361,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>height</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0</div><input id='attrs-ca4d83ae-096a-45bf-a90b-e045bf0ace33' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ca4d83ae-096a-45bf-a90b-e045bf0ace33' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7b1a846c-1560-406e-9841-580657245236' class='xr-var-data-in' type='checkbox'><label for='data-7b1a846c-1560-406e-9841-580657245236' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>geometric height</dd><dt><span>standard_name :</span></dt><dd>height_above_reference_ellipsoid</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>array([[0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       ...,
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.]], shape=(181, 361))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f7ec6153-ad98-418a-b6d4-6dc836225b9d' class='xr-section-summary-in' type='checkbox' checked /><label for='section-f7ec6153-ad98-418a-b6d4-6dc836225b9d' class='xr-section-summary' title='Expand/collapse section'>Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>b_east</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0</div><input id='attrs-9df65862-05c3-4641-9a83-40b3771f5ebd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9df65862-05c3-4641-9a83-40b3771f5ebd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-15728837-defe-4aaa-beeb-5e8892351c23' class='xr-var-data-in' type='checkbox'><label for='data-15728837-defe-4aaa-beeb-5e8892351c23' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>nT</dd><dt><span>long_name :</span></dt><dd>Eastward component</dd><dt><span>description :</span></dt><dd>Eastward component of the magnetic field vector calculated on 2020-02-27T00:00:00</dd></dl></div><div class='xr-var-data'><pre>array([[ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
       [-8.47463801e+03, -8.72654339e+03, -8.97588453e+03, ...,
        -7.96344697e+03, -8.22024635e+03, -8.47463801e+03],
       [-8.37293332e+03, -8.62589097e+03, -8.87641790e+03, ...,
        -7.86004237e+03, -8.11762396e+03, -8.37293332e+03],
       ...,
       [ 9.64556914e+01,  1.41072001e+02,  1.85668819e+02, ...,
         7.26560461e+00,  5.18451548e+01,  9.64556914e+01],
       [ 1.18041883e+02,  1.56244682e+02,  1.94410407e+02, ...,
         4.15954297e+01,  7.98196067e+01,  1.18041883e+02],
       [ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00]],
      shape=(181, 361))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>b_north</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.443e+04 1.428e+04 ... 1.814e+03</div><input id='attrs-341eb54d-7f32-4085-94af-117a0a0f44a5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-341eb54d-7f32-4085-94af-117a0a0f44a5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f0e3c0bb-5db3-43cd-8aea-f0b2809587c0' class='xr-var-data-in' type='checkbox'><label for='data-f0e3c0bb-5db3-43cd-8aea-f0b2809587c0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>nT</dd><dt><span>long_name :</span></dt><dd>Northward component</dd><dt><span>description :</span></dt><dd>Northward component of the magnetic field vector calculated on 2020-02-27T00:00:00</dd></dl></div><div class='xr-var-data'><pre>array([[14428.0874136 , 14276.2358104 , 14120.03552746, ...,
        14718.56089771, 14575.54408162, 14428.0874136 ],
       [14912.32492847, 14763.98877121, 14611.25638505, ...,
        15195.64271   , 15056.22304825, 14912.32492847],
       [15360.09850895, 15215.39835269, 15066.27405944, ...,
        15636.08033266, 15500.337657  , 15360.09850895],
       ...,
       [ 2837.76856698,  2836.39264597,  2834.01730454, ...,
         2837.52555788,  2838.14574469,  2837.76856698],
       [ 2331.23784843,  2329.13725987,  2326.25685122, ...,
         2333.09942235,  2332.55847037,  2331.23784843],
       [ 1814.03297877,  1811.37664567,  1808.1685497 , ...,
         1817.68728809,  1816.13673985,  1814.03297877]], shape=(181, 361))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>b_up</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.202e+04 5.202e+04 ... -5.673e+04</div><input id='attrs-e00ab1c8-04f9-4a3b-b3bf-82f9ad761e17' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e00ab1c8-04f9-4a3b-b3bf-82f9ad761e17' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3960f5a1-c609-4032-a34b-0aab7c7a5b65' class='xr-var-data-in' type='checkbox'><label for='data-3960f5a1-c609-4032-a34b-0aab7c7a5b65' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>nT</dd><dt><span>long_name :</span></dt><dd>Upward component</dd><dt><span>description :</span></dt><dd>Upward component of the magnetic field vector calculated on 2020-02-27T00:00:00</dd></dl></div><div class='xr-var-data'><pre>array([[ 52015.22218322,  52015.22218322,  52015.22218322, ...,
         52015.22218322,  52015.22218322,  52015.22218322],
       [ 51093.93232768,  51099.12069034,  51104.5871377 , ...,
         51084.39548166,  51089.0234778 ,  51093.93232768],
       [ 50151.60465675,  50161.66650224,  50172.28843567, ...,
         50133.17075678,  50142.10532539,  50151.60465675],
       ...,
       [-56367.51363282, -56370.6974352 , -56374.01882729, ...,
        -56361.561722  , -56364.4681694 , -56367.51363282],
       [-56554.33187371, -56555.98729384, -56557.70321019, ...,
        -56551.20431166, -56552.73740375, -56554.33187371],
       [-56731.72681549, -56731.72681549, -56731.72681549, ...,
        -56731.72681549, -56731.72681549, -56731.72681549]],
      shape=(181, 361))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9d220586-681f-4842-9726-6c7f63acfa7c' class='xr-section-summary-in' type='checkbox' checked /><label for='section-9d220586-681f-4842-9726-6c7f63acfa7c' class='xr-section-summary' title='Expand/collapse section'>Attributes: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.8</dd><dt><span>title :</span></dt><dd>IGRF14 magnetic field on 2020-02-27T00:00:00</dd><dt><span>crs :</span></dt><dd>WGS84</dd><dt><span>source :</span></dt><dd>Generated by spherical harmonic synthesis using library Harmonica (fatiando.org/harmonica) version 0.7.0.post79+g352418b98.</dd><dt><span>description :</span></dt><dd>Three components of the magnetic field vector calculated on 2020-02-27T00:00:00 in a geodetic coordinate system.</dd><dt><span>units :</span></dt><dd>nT</dd><dt><span>date :</span></dt><dd>2020-02-27T00:00:00</dd><dt><span>references :</span></dt><dd>https://doi.org/10.5281/zenodo.14218973</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>We can also calculate the intensity (or amplitude) and the inclination and
declination angles from the vector using
<a class="reference internal" href="../api/generated/harmonica.magnetic_vec_to_angles.html#harmonica.magnetic_vec_to_angles" title="harmonica.magnetic_vec_to_angles"><code class="xref py py-func docutils literal notranslate"><span class="pre">harmonica.magnetic_vec_to_angles</span></code></a>. We’ll add the resulting grids to our
<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.2.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a> and add a little bit of metadata:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">hm</span><span class="o">.</span><span class="n">magnetic_vec_to_angles</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">b_east</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">b_north</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">b_up</span><span class="p">)</span>
<span class="n">grid</span><span class="p">[</span><span class="s2">&quot;intensity&quot;</span><span class="p">],</span> <span class="n">grid</span><span class="p">[</span><span class="s2">&quot;inclination&quot;</span><span class="p">],</span> <span class="n">grid</span><span class="p">[</span><span class="s2">&quot;declination&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
<span class="n">grid</span><span class="o">.</span><span class="n">intensity</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Intensity&quot;</span>
<span class="n">grid</span><span class="o">.</span><span class="n">intensity</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;nT&quot;</span>
<span class="n">grid</span><span class="o">.</span><span class="n">inclination</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Inclination&quot;</span>
<span class="n">grid</span><span class="o">.</span><span class="n">inclination</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;degrees&quot;</span>
<span class="n">grid</span><span class="o">.</span><span class="n">declination</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Declination&quot;</span>
<span class="n">grid</span><span class="o">.</span><span class="n">declination</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;degrees&quot;</span>
<span class="n">grid</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in notebooks */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
  line-height: 1.6;
  padding-bottom: 4px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
}

.xr-header {
  border-bottom: solid 1px var(--xr-border-color);
  margin-bottom: 4px;
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-obj-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type,
.xr-group-box-contents > label {
  color: var(--xr-font-color2);
  display: block;
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
  margin-block-start: 0;
  margin-block-end: 0;
}

.xr-section-item {
  display: contents;
}

.xr-section-item > input,
.xr-group-box-contents > input,
.xr-array-wrap > input {
  display: block;
  opacity: 0;
  height: 0;
  margin: 0;
}

.xr-section-item > input + label,
.xr-var-item > input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item > input:enabled + label,
.xr-var-item > input:enabled + label,
.xr-array-wrap > input:enabled + label,
.xr-group-box-contents > input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item > input:focus-visible + label,
.xr-var-item > input:focus-visible + label,
.xr-array-wrap > input:focus-visible + label,
.xr-group-box-contents > input:focus-visible + label {
  outline: auto;
}

.xr-section-item > input:enabled + label:hover,
.xr-var-item > input:enabled + label:hover,
.xr-array-wrap > input:enabled + label:hover,
.xr-group-box-contents > input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
  white-space: nowrap;
}

.xr-section-summary > em {
  font-weight: normal;
}

.xr-span-grid {
  grid-column-end: -1;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.3em;
}

.xr-group-box-contents > input:checked + label > span {
  display: inline-block;
  padding-left: 0.6em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details,
.xr-group-box-contents > label {
  padding-top: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  grid-column: 1 / -1;
  margin-top: 4px;
  margin-bottom: 5px;
}

.xr-section-summary-in ~ .xr-section-details {
  display: none;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-children {
  display: inline-grid;
  grid-template-columns: 100%;
  grid-column: 1 / -1;
  padding-top: 4px;
}

.xr-group-box {
  display: inline-grid;
  grid-template-columns: 0px 30px auto;
}

.xr-group-box-vline {
  grid-column-start: 1;
  border-right: 0.2em solid;
  border-color: var(--xr-border-color);
  width: 0px;
}

.xr-group-box-hline {
  grid-column-start: 2;
  grid-row-start: 1;
  height: 1em;
  width: 26px;
  border-bottom: 0.2em solid;
  border-color: var(--xr-border-color);
}

.xr-group-box-contents {
  grid-column-start: 3;
  padding-bottom: 4px;
}

.xr-group-box-contents > label::before {
  content: "📂";
  padding-right: 0.3em;
}

.xr-group-box-contents > input:checked + label::before {
  content: "📁";
}

.xr-group-box-contents > input:checked + label {
  padding-bottom: 0px;
}

.xr-group-box-contents > input:checked ~ .xr-sections {
  display: none;
}

.xr-group-box-contents > input + label > span {
  display: none;
}

.xr-group-box-ellipsis {
  font-size: 1.4em;
  font-weight: 900;
  color: var(--xr-font-color2);
  letter-spacing: 0.15em;
  cursor: default;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 4MB
Dimensions:      (latitude: 181, longitude: 361)
Coordinates:
  * latitude     (latitude) float64 1kB -90.0 -89.0 -88.0 ... 88.0 89.0 90.0
  * longitude    (longitude) float64 3kB 0.0 1.0 2.0 3.0 ... 358.0 359.0 360.0
    height       (latitude, longitude) float64 523kB 0.0 0.0 0.0 ... 0.0 0.0 0.0
Data variables:
    b_east       (latitude, longitude) float64 523kB 0.0 0.0 0.0 ... 0.0 0.0 0.0
    b_north      (latitude, longitude) float64 523kB 1.443e+04 ... 1.814e+03
    b_up         (latitude, longitude) float64 523kB 5.202e+04 ... -5.673e+04
    intensity    (latitude, longitude) float64 523kB 5.398e+04 ... 5.676e+04
    inclination  (latitude, longitude) float64 523kB -74.5 -74.65 ... 88.17
    declination  (latitude, longitude) float64 523kB 0.0 0.0 0.0 ... 0.0 0.0 0.0
Attributes:
    Conventions:  CF-1.8
    title:        IGRF14 magnetic field on 2020-02-27T00:00:00
    crs:          WGS84
    source:       Generated by spherical harmonic synthesis using library Har...
    description:  Three components of the magnetic field vector calculated on...
    units:        nT
    date:         2020-02-27T00:00:00
    references:   https://doi.org/10.5281/zenodo.14218973</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-7d77bde7-5607-4bdc-95de-fd8ce6808861' class='xr-section-summary-in' type='checkbox' disabled /><label for='section-7d77bde7-5607-4bdc-95de-fd8ce6808861' class='xr-section-summary'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 181</li><li><span class='xr-has-index'>longitude</span>: 361</li></ul></div></li><li class='xr-section-item'><input id='section-32e57d1b-0cb2-4a64-b674-eee838761cdd' class='xr-section-summary-in' type='checkbox' checked /><label for='section-32e57d1b-0cb2-4a64-b674-eee838761cdd' class='xr-section-summary' title='Expand/collapse section'>Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-90.0 -89.0 -88.0 ... 89.0 90.0</div><input id='attrs-5a1a3a7b-420f-402f-bd8b-7cfa91fe4337' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5a1a3a7b-420f-402f-bd8b-7cfa91fe4337' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-040340b5-0acc-4515-b5e0-bcd08a2df45e' class='xr-var-data-in' type='checkbox'><label for='data-040340b5-0acc-4515-b5e0-bcd08a2df45e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>actual_range :</span></dt><dd>(-90.0, 90.0)</dd></dl></div><div class='xr-var-data'><pre>array([-90., -89., -88., -87., -86., -85., -84., -83., -82., -81., -80., -79.,
       -78., -77., -76., -75., -74., -73., -72., -71., -70., -69., -68., -67.,
       -66., -65., -64., -63., -62., -61., -60., -59., -58., -57., -56., -55.,
       -54., -53., -52., -51., -50., -49., -48., -47., -46., -45., -44., -43.,
       -42., -41., -40., -39., -38., -37., -36., -35., -34., -33., -32., -31.,
       -30., -29., -28., -27., -26., -25., -24., -23., -22., -21., -20., -19.,
       -18., -17., -16., -15., -14., -13., -12., -11., -10.,  -9.,  -8.,  -7.,
        -6.,  -5.,  -4.,  -3.,  -2.,  -1.,   0.,   1.,   2.,   3.,   4.,   5.,
         6.,   7.,   8.,   9.,  10.,  11.,  12.,  13.,  14.,  15.,  16.,  17.,
        18.,  19.,  20.,  21.,  22.,  23.,  24.,  25.,  26.,  27.,  28.,  29.,
        30.,  31.,  32.,  33.,  34.,  35.,  36.,  37.,  38.,  39.,  40.,  41.,
        42.,  43.,  44.,  45.,  46.,  47.,  48.,  49.,  50.,  51.,  52.,  53.,
        54.,  55.,  56.,  57.,  58.,  59.,  60.,  61.,  62.,  63.,  64.,  65.,
        66.,  67.,  68.,  69.,  70.,  71.,  72.,  73.,  74.,  75.,  76.,  77.,
        78.,  79.,  80.,  81.,  82.,  83.,  84.,  85.,  86.,  87.,  88.,  89.,
        90.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 1.0 2.0 ... 358.0 359.0 360.0</div><input id='attrs-46ae3b09-5942-426f-86e7-9181c8663677' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-46ae3b09-5942-426f-86e7-9181c8663677' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0b2e6e3b-beeb-4c5a-8b60-3b8229092bcc' class='xr-var-data-in' type='checkbox'><label for='data-0b2e6e3b-beeb-4c5a-8b60-3b8229092bcc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>actual_range :</span></dt><dd>(0.0, 360.0)</dd></dl></div><div class='xr-var-data'><pre>array([  0.,   1.,   2., ..., 358., 359., 360.], shape=(361,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>height</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0</div><input id='attrs-cd76ee32-1696-4498-99e5-778f44aaf6de' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cd76ee32-1696-4498-99e5-778f44aaf6de' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-512c2895-56ab-45a2-906f-59213f1441d3' class='xr-var-data-in' type='checkbox'><label for='data-512c2895-56ab-45a2-906f-59213f1441d3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>geometric height</dd><dt><span>standard_name :</span></dt><dd>height_above_reference_ellipsoid</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>array([[0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       ...,
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.]], shape=(181, 361))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d2a61458-e3ad-4bc9-8495-18f0dd2c1ec6' class='xr-section-summary-in' type='checkbox' checked /><label for='section-d2a61458-e3ad-4bc9-8495-18f0dd2c1ec6' class='xr-section-summary' title='Expand/collapse section'>Data variables: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>b_east</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0</div><input id='attrs-72aa9a4e-50a0-4222-b55a-332f9cca852a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-72aa9a4e-50a0-4222-b55a-332f9cca852a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5de2bafb-7a19-4f73-9b6c-acd065c6f60b' class='xr-var-data-in' type='checkbox'><label for='data-5de2bafb-7a19-4f73-9b6c-acd065c6f60b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>nT</dd><dt><span>long_name :</span></dt><dd>Eastward component</dd><dt><span>description :</span></dt><dd>Eastward component of the magnetic field vector calculated on 2020-02-27T00:00:00</dd></dl></div><div class='xr-var-data'><pre>array([[ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
       [-8.47463801e+03, -8.72654339e+03, -8.97588453e+03, ...,
        -7.96344697e+03, -8.22024635e+03, -8.47463801e+03],
       [-8.37293332e+03, -8.62589097e+03, -8.87641790e+03, ...,
        -7.86004237e+03, -8.11762396e+03, -8.37293332e+03],
       ...,
       [ 9.64556914e+01,  1.41072001e+02,  1.85668819e+02, ...,
         7.26560461e+00,  5.18451548e+01,  9.64556914e+01],
       [ 1.18041883e+02,  1.56244682e+02,  1.94410407e+02, ...,
         4.15954297e+01,  7.98196067e+01,  1.18041883e+02],
       [ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00]],
      shape=(181, 361))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>b_north</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.443e+04 1.428e+04 ... 1.814e+03</div><input id='attrs-f1b27560-d991-42e1-94e8-e19f851e6de4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f1b27560-d991-42e1-94e8-e19f851e6de4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1a68d5b7-d400-4c56-82cf-81fde16fe91c' class='xr-var-data-in' type='checkbox'><label for='data-1a68d5b7-d400-4c56-82cf-81fde16fe91c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>nT</dd><dt><span>long_name :</span></dt><dd>Northward component</dd><dt><span>description :</span></dt><dd>Northward component of the magnetic field vector calculated on 2020-02-27T00:00:00</dd></dl></div><div class='xr-var-data'><pre>array([[14428.0874136 , 14276.2358104 , 14120.03552746, ...,
        14718.56089771, 14575.54408162, 14428.0874136 ],
       [14912.32492847, 14763.98877121, 14611.25638505, ...,
        15195.64271   , 15056.22304825, 14912.32492847],
       [15360.09850895, 15215.39835269, 15066.27405944, ...,
        15636.08033266, 15500.337657  , 15360.09850895],
       ...,
       [ 2837.76856698,  2836.39264597,  2834.01730454, ...,
         2837.52555788,  2838.14574469,  2837.76856698],
       [ 2331.23784843,  2329.13725987,  2326.25685122, ...,
         2333.09942235,  2332.55847037,  2331.23784843],
       [ 1814.03297877,  1811.37664567,  1808.1685497 , ...,
         1817.68728809,  1816.13673985,  1814.03297877]], shape=(181, 361))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>b_up</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.202e+04 5.202e+04 ... -5.673e+04</div><input id='attrs-5ebdc17e-8447-436c-a0c7-0c5c079b0a93' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5ebdc17e-8447-436c-a0c7-0c5c079b0a93' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3a8fd673-0d2f-469b-993a-b3f927de1511' class='xr-var-data-in' type='checkbox'><label for='data-3a8fd673-0d2f-469b-993a-b3f927de1511' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>nT</dd><dt><span>long_name :</span></dt><dd>Upward component</dd><dt><span>description :</span></dt><dd>Upward component of the magnetic field vector calculated on 2020-02-27T00:00:00</dd></dl></div><div class='xr-var-data'><pre>array([[ 52015.22218322,  52015.22218322,  52015.22218322, ...,
         52015.22218322,  52015.22218322,  52015.22218322],
       [ 51093.93232768,  51099.12069034,  51104.5871377 , ...,
         51084.39548166,  51089.0234778 ,  51093.93232768],
       [ 50151.60465675,  50161.66650224,  50172.28843567, ...,
         50133.17075678,  50142.10532539,  50151.60465675],
       ...,
       [-56367.51363282, -56370.6974352 , -56374.01882729, ...,
        -56361.561722  , -56364.4681694 , -56367.51363282],
       [-56554.33187371, -56555.98729384, -56557.70321019, ...,
        -56551.20431166, -56552.73740375, -56554.33187371],
       [-56731.72681549, -56731.72681549, -56731.72681549, ...,
        -56731.72681549, -56731.72681549, -56731.72681549]],
      shape=(181, 361))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>intensity</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.398e+04 5.394e+04 ... 5.676e+04</div><input id='attrs-06d364d3-abca-4d9e-8ebf-ead8f815525d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-06d364d3-abca-4d9e-8ebf-ead8f815525d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ca35a296-6fc8-4d55-a92a-f1146a57484a' class='xr-var-data-in' type='checkbox'><label for='data-ca35a296-6fc8-4d55-a92a-f1146a57484a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>nT</dd><dt><span>long_name :</span></dt><dd>Intensity</dd><dt><span>description :</span></dt><dd>Upward component of the magnetic field vector calculated on 2020-02-27T00:00:00</dd></dl></div><div class='xr-var-data'><pre>array([[53979.19085337, 53938.80094778, 53897.669171  , ...,
        54057.55612003, 54018.79139749, 53979.19085337],
       [53896.07448507, 53900.35305341, 53904.86195854, ...,
        53888.21306002, 53892.02744723, 53896.07448507],
       [53115.17756923, 53123.50824654, 53132.30595028, ...,
        53099.9254649 , 53107.3159996 , 53115.17756923],
       ...,
       [56438.98322336, 56442.18771346, 56445.51466443, ...,
        56432.94466731, 56435.90197035, 56438.98322336],
       [56602.48278542, 56604.14288333, 56605.85710646, ...,
        56599.32678216, 56600.87727275, 56602.48278542],
       [56760.72183399, 56760.63700153, 56760.53471358, ...,
        56760.83874067, 56760.78910767, 56760.72183399]], shape=(181, 361))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>inclination</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-74.5 -74.65 -74.81 ... 88.17 88.17</div><input id='attrs-8f7d644e-8037-4025-b289-c1244255f3f1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8f7d644e-8037-4025-b289-c1244255f3f1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-112632db-a896-423e-bb1a-3544b878da28' class='xr-var-data-in' type='checkbox'><label for='data-112632db-a896-423e-bb1a-3544b878da28' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees</dd><dt><span>long_name :</span></dt><dd>Inclination</dd><dt><span>description :</span></dt><dd>Upward component of the magnetic field vector calculated on 2020-02-27T00:00:00</dd></dl></div><div class='xr-var-data'><pre>array([[-74.49694209, -74.65237584, -74.81250271, ..., -74.20026859,
        -74.34623045, -74.49694209],
       [-71.44316185, -71.44694411, -71.45092604, ..., -71.43620012,
        -71.43958022, -71.44316185],
       [-70.77012792, -70.77732031, -70.7849032 , ..., -70.7569204 ,
        -70.7633275 , -70.77012792],
       ...,
       [ 87.11627046,  87.11593492,  87.11590779, ...,  87.11786516,
         87.11691402,  87.11627046],
       [ 87.63651452,  87.63643436,  87.63651172, ...,  87.63714685,
         87.63675207,  87.63651452],
       [ 88.16855509,  88.1712351 ,  88.1744718 , ...,  88.16486822,
         88.16643258,  88.16855509]], shape=(181, 361))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>declination</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0</div><input id='attrs-e21387ba-06f7-40d6-be9d-6758c5307cb9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e21387ba-06f7-40d6-be9d-6758c5307cb9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-22487809-ba12-4397-99a7-99e0dd4a2c0e' class='xr-var-data-in' type='checkbox'><label for='data-22487809-ba12-4397-99a7-99e0dd4a2c0e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees</dd><dt><span>long_name :</span></dt><dd>Declination</dd><dt><span>description :</span></dt><dd>Eastward component of the magnetic field vector calculated on 2020-02-27T00:00:00</dd></dl></div><div class='xr-var-data'><pre>array([[  0.        ,   0.        ,   0.        , ...,   0.        ,
          0.        ,   0.        ],
       [-29.60946403, -30.58603833, -31.56294627, ..., -27.65729017,
        -28.63321685, -29.60946403],
       [-28.59521436, -29.5497034 , -30.50481137, ..., -26.68804683,
        -27.64133272, -28.59521436],
       ...,
       [  1.94673282,   2.84734037,   3.74833944, ...,   0.14670795,
          1.04652068,   1.94673282],
       [  2.8986877 ,   3.83780237,   4.77723319, ...,   1.02138387,
          1.95988345,   2.8986877 ],
       [  0.        ,   0.        ,   0.        , ...,   0.        ,
          0.        ,   0.        ]], shape=(181, 361))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-74beb52d-2ef8-45ab-ba34-5bebc9161e7e' class='xr-section-summary-in' type='checkbox' checked /><label for='section-74beb52d-2ef8-45ab-ba34-5bebc9161e7e' class='xr-section-summary' title='Expand/collapse section'>Attributes: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.8</dd><dt><span>title :</span></dt><dd>IGRF14 magnetic field on 2020-02-27T00:00:00</dd><dt><span>crs :</span></dt><dd>WGS84</dd><dt><span>source :</span></dt><dd>Generated by spherical harmonic synthesis using library Harmonica (fatiando.org/harmonica) version 0.7.0.post79+g352418b98.</dd><dt><span>description :</span></dt><dd>Three components of the magnetic field vector calculated on 2020-02-27T00:00:00 in a geodetic coordinate system.</dd><dt><span>units :</span></dt><dd>nT</dd><dt><span>date :</span></dt><dd>2020-02-27T00:00:00</dd><dt><span>references :</span></dt><dd>https://doi.org/10.5281/zenodo.14218973</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>The angles will be in decimal degrees and the intensity in nT. We can plot them
with PyGMT the same way we did the vector components:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">pygmt</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="n">cmaps</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;intensity&quot;</span><span class="p">:</span> <span class="s2">&quot;viridis&quot;</span><span class="p">,</span>
    <span class="s2">&quot;inclination&quot;</span><span class="p">:</span> <span class="s2">&quot;polar+h&quot;</span><span class="p">,</span>
    <span class="s2">&quot;declination&quot;</span><span class="p">:</span> <span class="s2">&quot;polar+h&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">cb_annot</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;intensity&quot;</span><span class="p">:</span> <span class="s2">&quot;a10000&quot;</span><span class="p">,</span>
    <span class="s2">&quot;inclination&quot;</span><span class="p">:</span> <span class="s2">&quot;a20+u</span><span class="se">\\</span><span class="s2">260&quot;</span><span class="p">,</span>
    <span class="s2">&quot;declination&quot;</span><span class="p">:</span> <span class="s2">&quot;a40+u</span><span class="se">\\</span><span class="s2">260&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;intensity&quot;</span><span class="p">,</span> <span class="s2">&quot;inclination&quot;</span><span class="p">,</span> <span class="s2">&quot;declination&quot;</span><span class="p">]:</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">grdimage</span><span class="p">(</span>
        <span class="n">grid</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmaps</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;W0/15c&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">coast</span><span class="p">(</span><span class="n">shorelines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
        <span class="n">position</span><span class="o">=</span><span class="s2">&quot;JMR+ml+o0.5c&quot;</span><span class="p">,</span>
        <span class="n">frame</span><span class="o">=</span><span class="p">[</span>
            <span class="n">cb_annot</span><span class="p">[</span><span class="n">c</span><span class="p">],</span>
            <span class="sa">f</span><span class="s2">&quot;x+l</span><span class="si">{</span><span class="n">grid</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;y+l</span><span class="si">{</span><span class="n">grid</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;intensity&quot;</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">basemap</span><span class="p">(</span><span class="n">frame</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;+t</span><span class="si">{</span><span class="n">grid</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">basemap</span><span class="p">(</span><span class="n">frame</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">shift_origin</span><span class="p">(</span><span class="n">yshift</span><span class="o">=</span><span class="s2">&quot;-h-0.5c&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/igrf_12_0.png" src="../_images/igrf_12_0.png" />
</div>
</div>
<p>We can clearly see the <a class="reference external" href="https://en.wikipedia.org/wiki/South_Atlantic_Anomaly">South Atlantic Magnetic Anomaly</a> in the intensity map!</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="transformations.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Grid transformations</p>
      </div>
    </a>
    <a class="right-next"
       href="../api/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">API Reference</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-at-given-points">Calculating at given points</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#changing-the-reference-ellipsoid">Changing the reference ellipsoid</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generating-a-grid">Generating a grid</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on Feb 26, 2026.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>